# Balking
- 参照: Java言語で学ぶデザインパターン入門 マルチスレッド編 第4章

## TL;DR
- GuardedObjectに対する処理において、
  ガード条件が満たされている場合、スレッドが処理を実行する
  ガード条件が満たされていない場合、処理を中断してすぐに返す

### 文脈
- 複数のスレッドがリソースを共有しているとき

### 問題
- 各スレッドがリソースに同時にアクセスすると、リソースの安全性が確保されない
- Guarded Suspensionを使用すると応答性が低下する

### 解決方法
- ガード条件によってリソースの状態が適切かどうかを表現する
- 安全性を失う恐れがある処理を行う前に、ガード条件が満たされているかどうかの判定を行う
  - ガード条件が満たされている場合、処理を実行する
  - ガード条件が満たされていない場合、処理を中断してすぐに返す

## 要素
### GuardedObject
- ガードされた処理とガード条件を満たす処理を持つオブジェクト
  - ガード条件が満たされていればすぐに実行される
  - ガード条件が満たされていなければ条件が満たされるまで待つ
  - ガード条件の真偽はGuardedObjectの状態によって変化する

## balkの結果の表現方法
- balkの発生を無視する(呼び出し側にbalkの発生を伝えない)
- balkの発生を返り値で表現する
- balkの発生を例外で表現する

## 適用可能性
- あえて処理の必要がない場合
- ガード条件が満たされるのを待ちたくない場合
  - ガード条件が満たされるのを待つ場合はGuarded Suspensionを使用する
- ガード条件が満たされるのが最初の一回だけという場合
  - ラッチ - 一回だけ状態が変化する変数

## 関連するパターン
- Single Threaded Execution
  - ガード条件が満たされておらず、スレッドにロックを獲得させる場合
- Guarded Suspension
  - ガード条件が満たされておらず、スレッドを待たせる場合
- Observer
