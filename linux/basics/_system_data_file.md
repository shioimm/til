# システムデータファイル
- 参照: 詳解UNIXプログラミング第3版 6. システムデータファイルと情報

## パスワードファイル
- `/etc/passwd` - ユーザーデータベース
  - `root`ユーザーのエントリーを含む
  - `nobody`ユーザーのエントリーを含む
  - 暗号化されたパスワードは別のファイルに保存する(シャドーパスワードファイル)
  - ユーザーにパスワードが存在しない場合がある
  - 各ユーザーのログインシェルを示すためのフィールドを持つ
- `<pwd.h>`で定義される`passwd`構造体に格納される
```c
struct passwd {
  char  *pw_name  // ユーザー名
  uid_t pw_uid    // ユーザーID番号
  gid_t pw_gid    // グループID番号
  char  *pw_dir   // 初期ワーキングディレクトリ
  char  *pw_shell // 初期シェル
};
```
- `getpwuid(3)` / `getpwnam(3)` - 与えられたログイン名、ユーザ uid、またはユーザ uuid のためにパスワードデータベースを検索
  - `getpwuid(3)` - iノード内のユーザーID番号をユーザーのログイン名に対応づけるため`ls(1)`が使用
  - `getpwnam(3)` - ユーザーがログイン名を打ち込んだ際に
  `login(1)`が使用

## シャドーパスワードファイル
- `/etc/shadow` - 暗号化されたパスワードを格納するためのファイル
  - ユーザー名
  - 暗号化されたパスワード
  - パスワードに関する他の情報
- シャドーパスワードがあれば通常の`/etc/passwd`は誰でも読み取れる
- `<shadow.h>`で定義される`spwd`構造体に格納される
```c
struct spwd {
  char *sp_namp;  // ユーザーログイン名
  char *sp_pwdp;  // 暗号化されたパスワード
  long sp_lstchg; // 1970年1月1日~パスワード最終変更日まで日数
  int  sp_min;    // パスワードが変更出来るようになるまでの日数
  int  sp_max;    // パスワードの変更が必要になるまでの日数
  int  sp_warn;   // パスワード失効の警告をする日数
  int  sp_inact;  // アカウントが不活性になるまでの日数
  int  sp_expire; // 1970年1月1日~アカウントが使用不能となるまでの日数
  int  sp_flag;   // 予約
}
```
