# タイマー / スリープ
- 参照: Linuxプログラミングインターフェース 20章 / 21章 / 22章

## TL;DR
- タイマー - 一定時間が経過したことを自プロセスへ通知する機能
- スリープ - プロセス・スレッドの実行を一定時間停止する機能

## API
### `alarm(2)`
- 一回だけタイムアウトするタイマーを設定する
- タイムアウト時`SIGALRM`を送信する
- それまでセットされていたタイマーを上書きする
  - 0秒を指定するとタイマーを停止する

#### 引数
- `seconds`を指定する
  - `seconds` - タイムアウトするまでの秒数

#### 返り値
- 以前にセットされたタイマーの残り時間を返す
  初めての場合は数値0を返す

### `setitimer(2)`
- 指定時間後にタイムアウトするインターバルタイマー(定期タイマー)を設定する

#### 引数
- `which`、`*new_value`、`*old_value`を指定する
  - `which` - タイマー種類
    - `ITIMER_REAL` - 実時間をカウント -> `SIGALRM`を送信
    - `ITIMER_VIRTUAL` - プロセスのユーザーCPU時間をカウント -> `SIGVALRM`を送信
    - `ITIMER_PROF` - プロセスのユーザーCPU時間 + システムCPU時間をカウント -> `SIGPROF`を送信
  - `*new_value` - 変更後のタイマーの値を示す`itimerval`構造体へのポインタ
    - `it_interval`に0以外を指定するとタイムアウト時にタイマーがリセットされる
    - `it_value`で残り時間を示す
  - `*old_value` - 変更前のタイマーの値を示す`itimerval`構造体へのポインタ
    - 変更前のタイマーを復元しない場合はNULLを指定する

```c
// itimerval構造体

struct itimerval {
  struct timeval it_interval; // インターバルタイマーの間隔
  struct timeval it_value;    // 次のタイムアウトまでの時間
};
```

#### 返り値
- 数値0を返す
  - エラー時は数値-1を返す

### `gettitimer(2)`
- タイマーの現在値(タイムアウトまでの時間)を取得

#### 引数
- `which`、`*curr_value`を指定する
  - `which` - タイマー種類
  - `*curr_value` - タイマーの現在値を保存する`itimerval`構造体へのポインタ

#### 返り値
- 数値0を返す
  - エラー時は数値-1を返す
