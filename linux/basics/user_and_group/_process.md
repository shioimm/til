# プロセスの権限
- 参照: Linuxプログラミングインターフェース 9章

## TL;DR
- 全てのプロセスは、その属性としてプロセスの権限を持つ
  - 実ID         - 実ユーザーID / 実グループID
  - 実効ID       - 実効ユーザーID / 実効グループID
  - saved set-ID - saved set-user-ID / saved set-group-ID
  - filesystem user ID / filesystem group ID
  - 追加グループID
- 実効ユーザーID / 実効グループIDは実ユーザーID / 実グループIDに等しい
  - 実効ユーザーID - そのプロセスを実行したユーザーのユーザーID
  - 実効グループID - そのプロセスを実行したユーザーのグループID

## 実ユーザーID / 実グループID
- プロセスのオーナー
- ログインシェルはパスワードファイルに記述されているフィールドを参照し、
  実ユーザーID / 実グループIDを決定する
  全てのプロセスはシェルの子孫であるため、
  起動時にシェルの実ユーザーID / 実グループIDを受け継ぐ

## ユーザーID / グループIDの種類
### ファイルアクセス許可の検査に使用
- 実効ユーザーID(アクセス許可の可否の検査に使用される)
  - そのプロセスを実行したユーザーを表すユーザーID
- 実効グループID(アクセス許可の可否の検査に使用される
  - そのプロセスを実行したユーザーのグループID↲
- 補助グループID群(アクセス許可の可否の検査に使用される
  - 一つのプロセスを実行したユーザーが複数のグループに所属できるようにするID群

### `access(2)` / `faccessat(2)`
- 実効ユーザーID / 実効グループIDではなく実ユーザーID / 実グループIDでアクセス検査を行う

## セットユーザーID / セットグループID
- 実行可能ファイルに与える特殊な属性
- ファイルのユーザー / グループ以外のユーザーが対象のファイルを操作できるようにする仕組み

### セットユーザーID
- ファイルの実効許可を持つ任意のプロセスが、
  セットユーザーIDが付与されたファイルを実行しようとした時、
  ファイルのユーザーIDが当該プロセスの実効ユーザーIDに置き換わる

### セットグループID↲
- ファイルの実効許可を持つ任意のプロセスが、
  セットグループIDが付与されたファイルを実行しようとした時、
  ファイルのグループIDが当該プロセスの実効グループIDに置き換わる

### セットユーザーIDの実行
- セットユーザーIDされた実行可能ファイルをプロセスがexecで実行するとき、
  プロセスのユーザーIDは以下のように変更される
  - 実ユーザーID
    - プロセスの元の実ユーザーIDのまま
  - 実効ユーザーID
    - 実行可能ファイルの所有者のユーザーIDに置き換えられる
  - 保存セットユーザーID
    - 実行可能ファイルの所有者のユーザーIDに置き換えられる
- グループIDは影響を受けない

### セットグループIDの実行
- セットグループIDされた実行可能ファイルをプロセスがexecで実行するとき、
  プロセスのグループIDは以下のように変更される
  - 実グループID
    - プロセスの元の実グループIDのまま
  - 実効グループID
    - 実行可能ファイルの所有者のグループIDに置き換えられる
  - 保存セットグループID
    - 実行可能ファイルの所有者のユーザーIDに置き換えられる
- 補助グループID群は影響を受けない
