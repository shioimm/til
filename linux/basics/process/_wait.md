# 子プロセスの監視
- 参照: 例解UNIX/Linuxプログラミング教室P185-224
- 参照: 詳解UNIXプログラミング第3版 7. プロセスの環境 / 8. プロセスの制御 / 9. プロセスの関係
- 参照: Linuxプログラミングインターフェース 2章 / 6章 / 26章

## 親子の終了関係
- 子プロセスが実行中に親プロセスが終了した場合
  -> 子プロセスが孤児化する -> プロセス`init`が子プロセスの親になる
- 親プロセスが実行中に子プロセスが終了した場合
  -> 親プロセスが`wait`していた場合: 親プロセスが子プロセスの終了を検知する
  -> 親プロセスが`wait`していなかった場合: 子プロセスがゾンビになる

## `wait`関数群
- `wait(2)` / `waitpid(2)`によって子プロセスの終了を監視する
  - 指定の子プロセスが終了するまで処理をブロックし、
    子プロセスが終了したら`wait`ステータスを取得する
  - カーネルは子プロセスが消費したCPU時間を自プロセスが持つ全子プロセスの合計値に加える

## `wait`ステータス
- `wait`関数群で得られる`wait`ステータスは子プロセスの状態変化を表す
  - 終了ステータス
    - 子プロセスが`exit(2)` / `_exit(2)`により終了したかどうか
    - 子プロセスが捕捉しないシグナルによって終了したかどうか
  - シグナルの捕捉状況
    - 子プロセスがシグナルにより実行を一時停止し、
      かつ`waitpid(2)`に`WUNTRACED`がセットされているかどうか
    - 子プロセスが`SIGCONT`により実行を再開し、
      かつ`waitpid(2)`に`WCONTINUED`がセットされているかどうか
- `wait`ステータス用標準マクロセットを使用してステータスをパースする
  - `WIFEXITED(status)`
  - `WIFSIGNALE(status)`
  - `WIFSTOPPED(status)`
  - `WIFCONTINUED(status)`
