# マウント
- 参照: Linuxプログラミングインターフェース 14章

## TL;DR
- 全てのファイルは単一のディレクトリツリーのどこかに含まれる
- ルートディレクトリ(`/`) - ディレクトリツリーの根
  - ルートディレクトリは自身以下に他のファイルシステムをマウントすることができる
    マウントされたファイルシステムはOS起動時に一つの木構造にまとめ上げられる
  - まとめ上げられたファイルシステム群はアプリケーションから一つのファイルシステムのように見える

## マウントポイント
- ディレクトリ以下にマウントされたファイルシステムの結節点(ノード)

### `bind`マウント
- 単一のファイルシステムを複数のマウントポイントへマウントすることが可能
  - `mount(2)`時に`MS_BIND`フラグを使用する
  - `mount(8)`時に`--bind`オプションを渡す
- 同じディレクトリ・ファイルを複数箇所から参照することができるようになる
  - Ex. `chroot`によるjail環境
- `bind`マウントしたディレクトリ以下にあるサブマウントはマウントポイントから参照できない
  - `mount(2)`時に`MS_BIND | MS_REC`フラグを使用し再帰bindを行うことで回避する
  - `mount(8)`時に`--rbind`オプションを渡し再帰bindを行うことで回避する

### スタックマウント
- 単一のマウントポイントに複数のファイルシステムをマウントすることが可能
  - 後からマウントしたファイルシステムが先にマウントしたファイルシステムを覆い隠す
  - 後からマウントしたファイルシステムをアンマウントすると
    先にマウントしたファイルシステムが見えるようになる

## マウント情報
- `/proc/mounts` - マウント済みのファイルシステム一覧
  - `/proc/PID/mounts` - プロセスごとのマウント名前空間内のマウントポイント一覧
- `/etc/mtab` - `/proc/mounts`と同じ・`mount(8)`に与えられたパラメータも表示
- `/etc/fstab` - システムが使用するファイルシステム一覧

### マウント情報のフォーマット
1. マウントしたデバイス名
2. デバイスのマウントポイント
3. ファイルシステム情報
4. マウントフラグ
5. バックアップ対象か否か
6. 整合性確認順序
