# 標準入出力
- 参照: 例解UNIX/Linuxプログラミング教室P149-184

## TL;DR
- C言語における標準的な入出力機能
  - `fopen` / `fclose`(開け閉め)
  - `fgetc` / `fputc` etc(読み書き)
  - `fseeko` etc(カレントファイルオフセットを移動させる操作)
- ライブラリ関数によって提供される
  - 低水準入出力機能を提供するシステムコールを利用して実装されるている

## ストリーム
- `fopen`の返り値である`FILE *型`の値
  - 低レベル入出力におけるファイルディスクルプタに相当する
- 入力ストリーム - 読むためのストリーム
- 出力ストリーム - 書くためのストリーム
- ストリームは自身の中に記憶領域(バッファ)を持つ

## バッファリング
- 入出力を効率的に行うための仕組み
  - 入出力時にデータが通る途中にある程度の大きさの記憶領域を設ける
  - 一回あたりのデータ入出力をある程度の大きい単位で行い、実際の入出力操作の回数を減らす
- 低水準入力にはバッファリング機能がない
- 標準入出力ライブラリは内部にバッファリング機能を持つ
  - バッファの大きさは`stdio.h`に`BUFSIZE`として定義されている

### フラッシュ
- `write`を呼び出して出力バッファの内容をカーネルに渡すこと
- `fclose`でストリームを閉じる際、そのストリームの出力バッファが自動的にフラッシュされる

### 種類
- 完全バッファリング
  - バッファを目一杯使う
  - ディスクにあるファイルへの読み書きに使う
- 行バッファリング
  - 行ごとに入出力する(改行文字`\n`ごと)
    - 一行が長い場合は途中で`read` `write`が呼ばれる
    - 行バッファリング(またはバッファリングなし)の入力ストリームから入力する際
      入力する前に行バッファリングの出力ストリームをすべてフラッシュする
  - 端末への入出力に使う
- バッファリングなし
  - エラーメッセージの出力などに使う
  - ストリームから読むたびに`read`し、ストリームを書くごとに`write`する

## 標準入出力による読み書き
- 一文字ずつ読み書きする
  - `getchar` `putchar` - 標準入出力への読み書き
  - `getc` `putc`       - 任意の入出力先への読み書き(マクロ)
  - `fgetc` `fputc`     - 任意の入出力先への読み書き(関数)
- 一行ずつ読み書きする
  - `fgets` `fputs` - ストリーム <-> プログラムで用意したバッファ間で一行ずつ読み書き
  - `gets`  `puts`  - 標準入出力 <-> プログラムで用意したバッファ間で一行ずつ読み書き
- 書式を指定して読み書きする
  - `fscanf` `fprintf` - 書式に従い文字列をストリームに入出力
  - `scanf` `printf`  - 書式に従い文字列を標準入出力に入出力
  - `sprintf` - 書式に従い文字列を指定のメモリ領域に保存(`\0`終端)
  - `sscanf`  - 書式に従い文字列を引数に指定した文字列から入力
- バイナリデータを読み書きする
  - `fread` `fwrite`
