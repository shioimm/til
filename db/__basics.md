# DB
#### データアクセスフロー
1. ユーザーによるインターフェースへのアクセス (アプリケーション、SQLインターフェース)
2. SQL文のネットワーク伝送
3. DBへの接続
4. DBMSによる処理
    - パーサによるSQL文の構文解析・変換
    - カタログマネージャからオプティマイザへのカタログ (統計情報) の提供
    - オプティマイザによる実行計画の作成・コスト計算
    - プラン評価による最適な実行計画の選択
5. 記憶装置へのアクセス・結果セットの取得
6. 結果セットのネットワーク伝送


## DBMSアーキテクチャ
#### クエリ評価エンジン
- SQL文を評価し、どのような手順で記憶装置へアクセスするかを決定する (実行計画)
  - アクセスメソッド - 実行計画に基づいたデータへのアクセス方法

#### バッファマネージャ
- バッファ用のメモリ領域 (データキャッシュ・ログバッファ) の使い方を管理する
  - データキャッシュ - ディスクにあるデータの一部を保持するためのメモリ領域
  - ログバッファ - 更新処理のSQLを格納するメモリ領域
    - ログバッファに格納された更新SQLは非同期にまとめて実行される
    - コミット時、永続化されたストレージに更新情報がログファイルとして書き込まれる
- ディスク容量マネージャと連携して動作する

#### ワーキングメモリ (ワークバッファ、ソートバッファ)
- ソートやハッシュなど特定の処理に利用される作業用領域

#### ディスク容量マネージャ
- ディスクのどこにどのようなデータを保存するか管理し、ディスクに対する読み書きを制御する
- バッファマネージャと連携して動作する

#### トランザクションマネージャ / ロックマネージャ
- データの整合性を保ちながらトランザクション、ロック処理を行う

#### リカバリマネージャ
- 定期的にバックアップを取得し、必要時にデータを復旧させる

## 統計情報
- オプティマイザが実行計画を立てる際に参照されるDBMSの内部情報
  - 各テーブルのレコード数
  - 各テーブルの列数と列のサイズ
  - 列値のカーディナリティ (値の個数)
  - 列値のヒストグラム (どの値がいくつあるかの分布)
  - 列内にあるNULLの数
  - インデックス情報

## 参照
- SQL実践入門: 高速でわかりやすいクエリの書き方 1.1 - 1.3
