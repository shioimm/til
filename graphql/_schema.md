# スキーマ
- 型 - アプリケーションの特性を反映する固有のオブジェクト
  - 型としてスカラー型(カスタムスカラー型)・オブジェクト型・Enum・ユニオン型を指定できる
- スキーマ - 型定義の集合
  - スキーマファイルは`.graphql`拡張子で保存される

## スキーマ定義
#### ルート型へのスキーマ定義
```
type Query {
  サービス名1: 型名1
  サービス名2(キー名: 引数): 型名2
}

type Mutation {
  サービス名1: 型名1
  サービス名2(キー名: 引数): 型名2
}

type Subscription {
  サービス名1: 型名1
  サービス名2(キー名: 引数): 型名2
}

schema {
  query: Query
  mutation: Mutation
  subscription: Subscription
}

```

### スキーマのドキュメント化
```
"""
型名の説明
"""
type 型名 {
  """
  キー1の説明
  """
  キー1: 型名1

  """
  キー2の説明
  """
  キー2: 型名2
}
```

### オブジェクト型
```
type 型名 {
  id: ID!
  キー1: 型名1
  キー2: 型名2
}

# Nullにならないキーは値に!をつける
```

### カスタムスカラー型
```
scalar カスタムスカラー型名

type 型名 {
  id: ID!
  キー1: 型名
  キー2: カスタムスカラー型名
}
```

### Enum
- Enumに指定した特定の文字列のうちどれかひとつを返す
```
enum Enum名 {
  文字列1
  文字列2
}

type 型名 {
  id: ID!
  キー1: 型名
  キー2: Enum名
}
```

### リスト(配列)
```
type 型名 {
  id: ID!
  キー1: [型名1]   # nullかもしれないリスト/型名1はnullかもしれない
  キー2: [型名2!]  # nullかもしれないリスト/型名2はnullではない
  キー3: [型名3]!  # nullではないリスト/型名3はnullかもしれない
  キー4: [型名4!]! # nullではないリスト/中型名4はnullではない
}
```

### コネクション(関連)
- 二つのオブジェクト型が関連している状態

#### 一対一の接続
```
type 型名A {
  id: ID!
  キー1: 型名1
  キー2: 型名2
}

type 型名B {
  id: ID!
  キー1: 型名1
  キー2: 型名A # 型名Aへの関連(belongs_to)
}
```

#### 一対多の接続
```
type 型名A {
  id: ID!
  キー1: 型名1
  キー2: [型名B] # 型名Bへの関連(has_many)
}

type 型名B {
  id: ID!
  キー1: 型名1
  キー2: 型名A # 型名Aへの関連(belongs_to)
}
```

#### 多対多の接続
```
type 型名A {
  id: ID!
  キー1: 型名1
  キー2: [型名B] # 型名Bへの関連(has_many)
}

type 型名B {
  id: ID!
  キー1: 型名1
  キー2: [型名A] # 型名Aへの関連(has_many)
}
```

#### スルー型(中間オブジェクト)
```
type 型名A {
  キー: [型名B] # 型名Bへの関連(has_many)
}

type 型名B { # 型名Aの自己参照を表現する
  キー1: 型名A
  キー2: 型名A
}
```

### ユニオン型
```
union ユニオン型名 = 型名A | 型名B

type 型名A {
  id: ID!
  キー1: 型名1
  キー2: 型名2
}

type 型名B {
  id: ID!
  キー1: 型名1
  キー2: 型名2
}

type ルート型のスキーマ名 {
  キー: ユニオン型名
}
```

### インターフェース
```
interface インターフェース名 {
  キー1: 型名1
  キー2: 型名2
}

type 型名A implements インターフェース名 {
  キー1: 型名1
  キー2: 型名2
}

type ルート型のスキーマ名 {
  キー: インターフェース名
}
```

### 入力型
- 引数に渡す型をまとめた型定義
```
input 入力型名 {
  キー1: 型名1
  キー2: 型名2
}
```

## 参照
- [GraphQL](https://graphql.org/)
- 初めてのGraphQL 4章
