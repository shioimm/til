# オニオンアーキテクチャ
- レイヤードアーキテクチャのインフラ層とドメイン層の依存関係を逆転させる
- ユースケースとその外側に境界を引く
- 境界を跨ぐ通信はインターフェースとなるアダプタを介して行う

### 依存関係の方向
- プレゼンテーション層 -> アプリケーション層 -> ドメイン層
  - 他の層から独立したインフラ層が存在する
  - リポジトリ (集約の格納と取得を担う) のインターフェースはドメイン層、実装クラスはインフラ層に定義される

### 通信の方向
- クライアント
  -> アダプタ (プレゼンテーション層)
  -> アプリケーション
- 結合テスト
  -> アダプタ (テスト層)
  -> アプリケーション
- アプリケーション
  -> アダプタ (インフラ層)
  -> DB、ファイル、外部サービス

### レイヤ
#### プレゼンテーション層
- クライアントとの入出力

#### アプリケーション層
- ユースケースの実現

#### ドメイン層
- ドメイン知識の表現
  - ドメインオブジェクト (エンティティ、値オブジェクト、ドメインイベン)
  - ドメインオブジェクトを利用するもの (ドメインサービス、リポジトリ、ファクトリ)

#### インフラ層
- DB、ファイル、外部サービスとの入出力

## CQRS (Command Query Responsibility Segregation: コマンドクエリ責務分離)
- 参照に使用するモデルと更新に使用するモデルを分離する
- アプリケーション層で参照系モデルを実装するために用いられる
- アプリケーション層に参照系モデルとして特定のユースケースに特化した値の型と、
  当該参照系モデルオブジェクトを取得するためのサービスをそれぞれ定義する

## 参照
- ドメイン駆動設計 モデリング実践ガイド
