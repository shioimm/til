# Mobile IP
- 移動体端末などにおいて、ホストが接続しているサブネットが変わっても
  IPアドレスが変わらないようにする技術

## 仕組み
1. ホストが移動後、移動ホストに対して送信されたパケットに対して
   ホームエージェント(HA)がARPパケットを返信し、移動ホスト宛のパケットを受信する
2. HAはトンネリングを使って移動ホストへパケットを転送
3. 外部エージェント(FA)がパケットを受け取り、トンネリングに使用したIPヘッダを削除し、
   移動ホストにパケットを渡す

- 移動ホスト - 移動してもIPアドレスが変わらないホスト
- ホームネットワーク - 移動しない時に接続するネットワーク
- ホームアドレス - ホームネットワークで利用するIPアドレス
- 気付アドレス - 移動した後のサブネットのIPアドレス
  - 移動するたびに変化する可能性がある
- HA - ホームネットワークに存在し、移動ホストがどこにいるか監視し、移動先にパケットを転送する
- FA - 移動先で移動ホストをサポートする
  - 異動ホストが接続する可能性のあるすべての箇所に必要

## Mobile IPv6
### Mobile IPの問題点
- FAが存在しないネットワークには移動できない
- IPパケットが三角形のルートを辿ることになり効率が悪い
- 移動ホストから通信相手に送信するIPパケットの送信元IPアドレスがホームアドレスになっており、
  その組織のIPアドレスと異なると移動先のルーターでパケットが廃棄される可能性がある(ファイアウォール)

### Mobile IPからの変更点
- 外部エージェントの機能はMobile IPv6を実装した移動ホスト自身が担う
- 経路最適化により、HAを経由せず直接通信できる
- IPv6ヘッダの送信元IPアドレスには気付アドレスをつけてファイアウォールで廃棄されないようにする

## 参照
- マスタリングTCP/IP 入門編
