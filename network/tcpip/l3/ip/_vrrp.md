# VRRP
- Virtual Router Redundancy Protocol
- 複数のルーターによる冗長化によって耐障害性を高める仕組み
  - 複数のルーターを一つにまとめて運用する
  - 複数のうち一つがマスタールーター
  - 平時はマスタールーターをデフォルトルーターとする
  - マスタールーターが故障した際はバックアップルーターを使って通信を行う

## 仕組み
1. マスタールーターは定期的にVRRPパケットをマルチキャストしている
2. バックアップルーターが3回分のVRRPパケットを受け取れなかった際、
   マスタールーターに障害が発生したと判断しバックアップルーターの一つがデフォルトルーターとなる
    - バックアップルーター群は切り替わる優先順位を決めて運用される
3. マスタールーターからバックアップルーターに切り替わる際、MACアドレスとIPアドレスが引き継がれる
    - バックアップルーターは自身のNICのMACアドレスを使用せず、
      VRRP専用の仮想ルーターMACアドレスを使用する
    - 仮想ルーターMACアドレスにはマスタールーターのMACアドレスを設定しておく
    - バックアップルーターは自身のNICにデフォルトルートとは異なるIPアドレスを設定し、
      デフォルトルートには仮想IPアドレスを設定する
4. バックアップルーターは自分へパケットを誘導するためにGARPパケットを流す
    - スイッチングハブのMACアドレステーブルを更新させる

## 参照
- マスタリングTCP/IP 入門編
