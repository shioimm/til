# TLS 1.3 ハンドシェイク
- 毎回ハンドシェイクでは暗号化アルゴリズムとハッシュ関数の選択、
  鍵交換の実行、通信相手とハンドシェイク自体のメッセージ認証が行われる

#### 暗号化アルゴリズムとハッシュ関数
- ハンドシェイクでネゴシエーションされた暗号スイートを用いて決定する
- クライアントは自身が対応している暗号スイートの一覧 (と暗号化パラメータ) をClientHelloメッセージで指定する
- サーバーはClientHelloメッセージで受け取った暗号スイートの一覧から暗号スイートを1つ選択する
- サーバーはクライアントが提案した選択肢に合意できない場合、
  `supported_groups`拡張を利用して自分が対応しているアルゴリズムをクライアントに伝える

#### 鍵交換と必要な情報の共有
- サーバーはClientHelloメッセージで提案された中から自ら選択した暗号スイートに対し、
  同じくClientHelloメッセージに含まれる暗号化パラメータを用いて鍵交換を行う

#### 署名アルゴリズム
- サーバーはハンドシェイク中に`signature_algorithms`拡張を用いて署名アルゴリズムを指定する
- 決定した署名アルゴリズムはTLSプロトコルの署名、証明書を用いた署名の検証に使用される
  - `signature_algorithms_cert`拡張を使って証明書の署名に別のアルゴリズムを指定することも可能

#### 事前共有鍵
- TLS1.3では認証に (署名に利用する) 証明書もしくは事前共有鍵 (pre-shared keys) が利用可能
  - セッションリザンプションで利用できる
- クライアントが1つもしくは複数の事前共有鍵を持っており、それを利用したい場合、
  `psk_key_exchange_modes`拡張を使用してサーバーに意向を伝える
  - 事前共有鍵の識別子 (ID) を指定するのに`pre_shared_key`拡張を使用する

## 鍵導出関数 HKDF (HMAC-based Key Derivation Function)
- TLS1.3でハンドシェイク時に共有される秘密鍵を導出するアルゴリズムが新たに設計された
- HKDFは短いシードや補助入力から秘密鍵として利用できる複数の安全な疑似乱数を取得する関数
  - HKDF-Extract
  - HKDF-Expand

## 0-RTT
- TLS1.3では、以前にサーバーとやり取りしたことがあるクライアントは
  ClientHelloの直後にいきなりアプリケーションデータを暗号化して送信することが可能

## 参照
- プロフェッショナルSSL/TLS
- 暗号技術入門 第3版
- パケットキャプチャの教科書
