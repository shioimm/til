# IPv6パケットフォーマット
### バージョン (4ビット)
- インターネットプロトコルのバージョン番号 (6: IPv6)

### トラフィッククラス (8ビット)
- 経路上のルーターにデータグラムの処理方法を伝えるためのフィールド
- 上位6ビットがDiffservで利用するDSCP (Differentiated Services Code Point) を格納するDS Fieldで利用される
- 下位2ビットがECN (Explicit Congestion Notification) で利用される

### フローラベル (20ビット)
- 通信フロー (一連のデータのまとまり) を識別するためのラベル

### ペイロード長 (16ビット)
- ヘッダを除いたIPペイロード長
  - IPv6パケット長 = ヘッダ長 (40バイト固定) + ペイロード長

### ネクストヘッダ (8ビット)
- IPv6ヘッダの直後に続くヘッダ
  - IPペイロードを構成するトランスポート層プロトコルの種類を示す番号
  - またはIPv6の拡張ヘッダが続く場合は拡張ヘッダの種類を示す番号

#### IPv6拡張ヘッダ

| 番号 | プロトコル                           |
| -    | -                                    |
| 0    | Hop-by-Hopオプションヘッダ           |
| 43   | ルーティングヘッダ                   |
| 44   | フラグメントヘッダ                   |
| 50   | Encapsulating Security Payloadヘッダ |
| 51   | 認証ヘッダ                           |
| 60   | 宛先オプションヘッダ                 |
| 135  | モビリティヘッダ                     |
| 139  | Host Identity Protocol               |
| 140  | Shim6 Protocol                       |
| 253  | 実験やテスト用                       |
| 254  | 実験やテスト用                       |

- 経路の途中のノードではIPv6拡張ヘッダを解釈しない

### ホップリミット (8ビット)
- ホップできるノード数の上限
- ホップするたびにルーターによって一つずつ減じられる
- 0になった場合は破棄され、ICMPv6で送信元ノードへ知らせる
- ルーターはTTLが0のパケットを転送してはいけない (ホスト同士は同一ネットワーク上なら受信可能)

### 送信元IPv6アドレス (128ビット)
- 送信元IPv6アドレス

### 送信先IPv6アドレス (128ビット)
- 送信先IPv6アドレス

### IPv6ペイロード
- IPv6ペイロード

## 参照
- Linuxプログラミングインターフェース 58章
- Software Design 2021年5月号 ハンズオンTCP/IP
- マスタリングTCP/IP 入門編
- パケットキャプチャの教科書
