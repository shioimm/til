# IPフラグメンテーション
## (前提)
- データリンクによってMTUが異なる
- IPはデータリンクごとのMTUの差異に左右されることなく利用できる必要がある

## パケットの分割・再構築
- IPデータグラムサイズが送信先のデータリンクのMTUよりも大きいという状況が発生する度、
  ノードは必要に応じてIPデータグラムを分割する
- IPv6は拡張ヘッダであるフラグメントヘッダを追加することで断片化を行うことが可能
  - MTU探索の結果MTUを超えるパケットがある場合は送信元ホストが断片化を実施する
- IPv6ではエンドノードのみがフラグメンテーションを行うことができる

#### Per-Fragmentヘッダ (RFC8200)
- 元のIPv6パケットの情報
  - IPv6ヘッダ + (あれば) 一部のIPv6拡張ヘッダ
- フラグメント化された各パケットに含められる

#### Extension & Upper-Layerヘッダ (RFC8200)
- 上位層のヘッダ情報
- フラグメント化された先頭のパケットに含まれる

## フラグメンテーションのためのフィールド
#### Next Header
- フラグメントヘッダ (44) を指定

#### Fragment Offset
- フラグメンテーションされたパケットの相対位置を示す

####  Mフラグ
- 当該フラグメントが最後のフラグメントか、後続するフラグメントがあるかを示すビット

#### Identification
- フラグメント識別子

## 参照
- Linuxプログラミングインターフェース 58章
- Software Design 2021年5月号 ハンズオンTCP/IP
- マスタリングTCP/IP 入門編
