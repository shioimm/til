# Socket API
#### IPv6のみで通信するアプリケーションの動作
1. IPv6ソケット (`AF_INET6` / `PF_INET6`) を作成
2. ソケットに対して必要に応じて初期設定を行う
3. 通信相手のFQDNを用いて名前解決を行い、送信先のIPv6アドレス情報を取得
    - 名前解決の結果が複数ある場合、最終的にどのIPv6アドレスを利用するのかを判断する必要がある
      - e.g. 得られた結果順に接続を試み、最初に成功した結果を利用するなど
4. (TCP等の場合) 通信相手との初期接続を確立
5. ソケットに対して書き込みや読み込みなどの操作を行う
6. 通信の終了後、ソケットを閉じる

#### IPv4もしくはIPv6で通信するアプリケーションの動作
1. IPv4ソケット (`AF_INET` / `AF_INET6`) とIPv6ソケット (`AF_INET6` / `PF_INET6`) を作成
2. 両ソケットに対して必要に応じて初期設定を行う
3. 通信相手のFQDNを用いて名前解決を行い、送信先のIPアドレス情報を取得
    - 名前解決によって得られたIPv4アドレスはIPv4ソケットに対して利用し、
      IPv6アドレスはIPv6ソケットに対して利用する
4. (TCP等の場合) 通信相手との初期接続を確立
    - IPv4とIPv6のどちらを利用するのかを判断する
      - e.g. IPv6を試して成功すればIPv6、失敗すればIPv4を利用する、通信品質が高い方を採用するなど
5. 利用するソケットに対して書き込みや読み込みなどの操作を行う
6. 通信の終了後、ソケットを閉じる

## API
- `getaddrinfo()` - 名前解決
  - ドメイン名・サービス名・ヒントを渡すとインターネットアドレスを格納するaddrinfo構造体を一つ以上返す
  - 返り値のアドレスの順はRFC 6724で定義されているがポリシーテーブルの設定により変更が可能
- `inet_pton()` - IPv6アドレスを表す文字列 -> 128ビットのバイナリデータへ変換
- `inet_ntop()` - 128ビットのバイナリデータ -> IPv6アドレスを表す文字列へ変換

## 参照
- プロフェッショナルIPv6
