# ルーティングプロトコル
- ルータ自身が動的にルーティングテーブルを更新するためにルータ同士で協調する仕組み

## IGP (Interior Gateway Protocol)
- ネットワーク (AS) 内の動的ルーティングのための仕組み
- RIP、RIP2、OSPFなどのプロトコルが利用される

### RIP (Routing Information Protocol)
- 経路情報を定期的に(30秒周期)ネットワーク上にブロードキャストする
  - 6回待っても経路情報が届かない場合は接続切れと判断する
- 距離ベクトル型プロトコル
  - ホップ数(通過するルーター数)によって距離を計測する
- 距離ベクトルアルゴリズムによって距離ベクトルデータベースを作成し、
  距離が小さい経路を抜き出してルーティングテーブルを生成する
- 1種類のパケットで動作する
  - 経路制御情報を利用し、ネットワークが接続されているかどうかを確認しながら
    他のネットワークの情報も流す

### RIP2 (RIPバージョン2)
- 経路制御情報の交換のためにマルチキャストを使用する
- サブネットマスクに対応
- 一つのネットワーク上で論理的に独立した複数のRIPが使えるようになっている
- BGPなどから得た経路制御情報を、RIPを使ってもAS内に通知する外部ルートタグ機能を実装
- パスワードを用いて、自分が認識できるパスワードを持っているパケットのみを受容する

### OSPF (Open Shortest Path First)
- 各リンクに重み (コスト) をつけることができ、重みが小さくなるように経路が選択される
- サブネットマスクに対応
- トラフィックの軽減のため、ネットワークの論理的な領域を意味するエリアの概念を導入
  - ネットワークをエリアに分けることによって不必要なルーティングプロトコルのやりとりを減少させる
- IPヘッダのサービスタイプフィールドごとに複数のルーティングテーブルを作成できる
- 役割ごとに5種類のパケットを使い分ける

## EGP (Exterior Gateway Protocol)
- ネットワーク (AS) 間の動的ルーティングのための仕組み
- BGPが利用される

### BGP (Border Gateway Protocol)
- 経路ベクトル型のEGPプロトコル
  - 通過するASの数によって距離を計測する
  - 各AS間の接続契約に基づいたパケット転送を行う
- ネットワークに変更があった際に差分アップデートを行う
- 目的とするネットワークアドレスにパケットを送った際、
  そこに到達するまでに通過するAS番号のリスト(AS経路リスト)を作る

#### BGPスピーカー
- 経路制御情報を交換するルーター
- BGPスピーカーはAS間でBGPの情報を交換する全てのASと対等にBGPコネクションを確立する

## 経路制御アルゴリズム
#### 距離ベクトル型
- 距離と方向によって目的のネットワークやホストの位置を決定する
- ルーター間でネットワークの方向と距離に関する情報が交換される
- ネットワークの方向と距離の情報からルーティングテーブルを作成する
- 経路制御情報が安定するまで時間がかかる、経路にループが生じやすい

#### リンク状態型
- ルーターがネットワーク全体の接続状態を理解して経路制御を作成する
- 各ルーターが他のルーターと同じ経路制御表を持つために、お互い素早く同期を行う
- トポロジ情報の管理や処理に高いCPU能力と多くの資源が必要

## 参照
- Linuxプログラミングインターフェース 58章
- Software Design 2021年5月号 ハンズオンTCP/IP
- マスタリングTCP/IP 入門編
