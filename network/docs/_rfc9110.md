# RFC 9110 HTTP Semantics
## Terminology and Core Concepts
- resource - リクエストの対象。URIによって識別される
- representation - リソースの状態の反映。リクエストに基づきコンテンツネゴシエーションによって選択される
- client - 1つ以上のHTTPリクエストを送信する目的でサーバとの接続を確立するプログラム
- server - クライアントからの接続を受け入れ、HTTPリクエストを処理し、HTTPレスポンスを送信するプログラム
- messages - 接続を介して交換される情報
- user agent - リクエストを開始するさまざまなクライアントアプリケーション (Webブラウザなど)
  - Webブラウザ、CLI、デジタルサイネージスクリーン、家電製品、ファームウェア更新スクリプト、モバイルアプリなど
- origin server - 特定のターゲットリソースに対して権威あるレスポンスを生成できるプログラム
  - 公開Webサイト、ネットワーク機器、オフィス機器、自律型ロボット、モバイルアプリなど
- intermediary - オリジンサーバ - UA間を中継しリクエストを実現するためのプログラム
  - proxy - クライアントが利用するメッセージ転送エージェント
  - gateway (reverse proxy) - オリジンサーバが利用するメッセージ転送エージェント
  - tunnel - メッセージを変更せずにユーザーエージェント/オリジンサーバ間を中継する
- cache - 過去のレスポンスメッセージを保持するローカルストアと、そのメッセージの保存・取得・削除を制御するシステム

## Identifiers in HTTP
### URI References
- HTTPではURI Referencesの形式ごとに使用可能な場面を厳密に定義している
  - 明示がない場合URI ReferencesはターゲットURIを基準として相対的に解析される

```
URI-reference = リソースを指す文字列の総称
absolute-URI  = スキームを含む完全なURI
relative-part = 相対パス。ベースURIと結合して解決される
partial-URI   = relative-part [ "?" query ]
authority     = ネットワーク上の接続先 [ userinfo "@" ] host [ ":" port ]
uri-host      = ホスト名またはIPアドレス
port          = TCP/UDPのポート番号
path-abempty  = 空文字列または / で始まるパス。authority を伴うURIで使用される
segment       = パスを / で区切った最小単位
query         = ? 以降の付加情報
absolute-path = /から始まるパス形式
```

### HTTP-Related URI Schemes
- URIの存在はサーバの存在や有効性を保証しない
- URI名前空間は委任に基づく分散的な仕組みとして成り立っている
- `http-URI = "http://" + authority + path-abempty [ + "?" + query ]`
  - ポートの規定値は80
  - authorityによってオリジンが定まり、空のホスト識別子を持つURIは無効とされる
- `https-URI = "https://" + authority + path-abempty [ + "?" + query ]`
  - ポートの規定値は443
  - https / httpは別個のオリジン
- http(s) URIは仕様に基づく正規化によって同一性を判断される
  - 既定ポート、大文字小文字、パーセントエンコードなどが考慮される
  - 正規化の結果等価であるURIは同一リソースを指すとみなされる
- http(s) URIにuserinfoを含めることは非推奨
- フラグメント識別子 (`#`) はURIスキームとは独立した要素であり、使用可否は各プロトコル要素のABNF 規則で定まる

### Authoritative Access
- 特定の識別子を解決して識別されたリソースへのアクセスを行う際、
  そのアクセスがリソース所有者によって制御されているとクライアントが信頼できる形で行われること
- アクセスが許可されるかどうかのプロセスはURIスキームによって定義される

#### URI Origin
- 正規化されたスキーム / ホスト / ポートの3要素からなる組。HTTPにおける名前空間と権限の境界を形成する。

#### http Origin
- URIに含まれるauthority (host:port) によって特定され、
  そのhost:portでTCP接続を受け付けるサーバがそのURIを代表しているとみなされるオリジン (論理的な起点)

#### https Origin
- URIに含まれるhost:portではなく、そのoriginに対して有効であるとクライアントが信頼する証明書に対応する秘密鍵を持つ
  サーバに対して確立される権威 (authority) に基づくオリジン
- H1 - URI originのhostに対してTLSで保護された接続が直接確立されている場合にauthorityを認める
- H2/H3 - 証明書に含まれる複数のhostに対して接続可能であるとクライアントが信頼できる場合にauthorityを認める

#### https Certificate Verification
- httpsでURIをdereferenceする際、クライアントは接続先サービスの身元がそのURIのoriginと正しく一致していることを
  RFC6125に基づく証明書検証によって確認する

#### IP-ID Reference Identity
- httpsでホストにIPリテラルを用いる場合、参照アイデンティティはIP-ID (P Address Identity) となり、
  証明書のsubjectAltNameに含まれるiPAddressと完全一致する必要がある

## Fields
- フィールドはメッセージのヘッダおよびトレーラにおいて送受信される
-
### Field Names

```
 field-name     = token
```

- フィールド名は大文字・小文字を区別しない
- フィールドの解釈は同一のHTTPメジャーバージョン内のマイナーバージョン間で変化しない
- プロキシはConnectionヘッダフィールドにそのフィールド名が列挙されていない限り
  or 当該フィールドを遮断もしくは変換するよう明示的に設定されていない限り、
  認識できないヘッダフィールドをオリジンに転送しなければならない
- プロキシ以外の受信者は認識できないヘッダフィールドおよびトレーラフィールドを無視する
