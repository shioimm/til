# コンテナ技術
- 参照: [コンテナ化とは何か](https://developer.ibm.com/jp/videos/new-builders-containerization/)
- 参照: [Linux コンテナの概要](https://www.redhat.com/ja/topics/containers)
- 参照: [コンテナーとは？ Kubernetesとは？ 導入や運用、ユースケースを解説](https://codezine.jp/article/detail/11336)
- 参照: [サーバレスとコンテナ：同じところと違うところ](https://sumologic.digitalstacks.net/blog/serverless-vs-containers/)
- 引用: [What is Kubernetes?](https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/)
- 参照: [What is a Container?](https://www.docker.com/resources/what-container)
- 翻訳参考: [DeepL](https://www.deepl.com/translator)
- 参照: [「コンテナって何？　どう使える？」――ソフトウェア開発の課題を解決するコンテナ技術 (3/3)](https://www.atmarkit.co.jp/ait/articles/1901/29/news005_3.html)

## TL;DR
- 実行環境を他のプロセスから隔離し、その中でアプリを動作させる技術
- 軽量の仮想化アーキテクチャ
  - Docker -> コンテナ型の仮想環境を作成、配布、実行するためのプラットフォーム
    - 引用: [Docker入門（第一回）～Dockerとは何か、何が良いのか～](https://knowledge.sakura.ad.jp/13265/)
- 個別のアプリケーションと実行に必要なすべてのファイルをパッケージ化し、
  移植可能な隔離された環境内に分離させる技術
- ホストサーバー上に論理的な区画(コンテナ)を作り、個別のサーバーのように扱う
- ホストサーバーとの間でシステムリソースを共有するため、
  仮想マシンよりも効率的に稼働させることができる
- 基盤となる外部ホストから分離されている
  - 摩擦のないアプリケーション展開を可能にする
  - コンテナ化されたアプリケーションをホスト間で簡単に移動

## 特徴
- 効率
  - システムリソースの効率的利用
  - イメージの作成が簡単かつ効率的(仮想マシンとの比較において)
- イメージの不変性
- アプリケーションとインフラの分離性
- 開発・テスト・運用環境の一貫性
- ホスト間の移植性
- モジュール性
  - アプリケーションの実行に必要なモジュールをコンテナとしてまとめることができる
    -> 複数のコンテナを組み合わせて一つのアプリケーションを構成するアーキテクチャとの親和性が高い
    -> マイクロサービスアーキテクチャ

## 仮想マシンとの比較
### コンテナ
- アプリケーション層を抽象化したもの
  - コードと依存関係を一緒にパッケージ化する
  - 複数のコンテナを同じマシン上で実行する場合、他のコンテナとOSカーネルを共有する

### 仮想マシン
- 物理的なハードウェアを抽象化したもの
  - 単体のサーバーを多数のサーバーに変換する
  - 各仮想マシンにOS、アプリケーション、必要なバイナリ、ライブラリのコピーが含まれる

## サーバーレスとの比較
- 参照・引用: [サーバレスとコンテナ：同じところと違うところ](https://sumologic.digitalstacks.net/blog/serverless-vs-containers/)

### 類似点
- アプリケーションコードをデプロイできる
- 仮想マシンよりも効率的
- アプリケーションはホスト環境から隔離されている
- 効果的にスケールするためにオーケストレーションツールが必要
- 主要なオープンソースのサーバーレスフレームワークはDockerコンテナ技術を利用している

### 違い
- ホスト環境
  - コンテナは最新のLinuxサーバと特定のバージョンのWindowsで実行可能
  - サーバーレスは特定のホストプラットフォーム(ほとんどはパブリッククラウド)で実行される
- セルフサービス能力
  - 独自のオンプレミスホスト環境と、ECSなどのパブリッククラウドサービスの両方を使用できる
  - サーバーレスは特定のホストプラットフォーム(ほとんどはパブリッククラウド)で使用できる
- コスト
  - サーバーレス環境はクラウドにホストされているため、利用に費用がかかる
  - コンテナはオープンソースを使用して無料で自分でコンテナ環境を設定することができる
- サポートされている言語
  - コンテナはホストサーバがサポートしていれば任意の言語を使用できる
  - サーバーレス言語はサーバーレスプラットフォームによって異なる
- ステートフル
  - コンテナ環境でははステートフルなコンテナ化されたアプリの作成が可能
  - ほとんどのサーバーレスプラットフォームでは
    ステートレスワークロードをサポートするように設計されている
    - サーバレスプラットフォーム内から外部ストレージサービスに接続できるが、
      機能自体はステートフルにできない

### 用途
#### コンテナ
- アプリケーションコードがデリバリーチェーンを下るときに、環境パリティを維持する
- 異なるホストサーバー間でアプリケーションをすばやく移動する
- オンプレミスとクラウドの間でワークロードを移動する機能を保持する
- サービスを継続的に利用可能にする

#### サーバーレス
- リソースを集中的に使用するコードを一回に限り迅速に実行する
  - ex. ユーザーが画像をアップロードするたびに画像のサイズを変更するコードを実行する
- 仮想サーバーをセットアップしたり、継続的にクラウドリソースに料金を支払うことなく
  クラウドで限定的なアプリケーションコードを実行する

## コンテナ作成の3段階プロセス
1. マニフェスト(ex. Dockerfile)
    - コンテナ自体の詳細の記述
2. イメージ本体(ex. Dockerイメージ)
    - アプリケーションの実行に必要なファイル群が格納されたディレクトリ
    - コンテナ本体のひな形
3. コンテナ本体
    - すべてのランタイム、ライブラリー、バイナリーが含まれる

## コンテナアプリケーション開発プロセス
1. コンテナアプリケーションのビルド(Build)
    - アプリケーションの実行に必要なプログラム本体／ライブラリ／ミドルウェア、
      OSやネットワークの設定をひとつにまとめてイメージを作成
    - あるいはパブリックレジストリから必要なイメージを取得
2. コンテナイメージの共有(Ship)
    - 開発に必要なイメージをレジストリで共有
3. コンテナアプリケーションの実行(Run)
    - コンテナの起動／停止／破棄
    - 複数のコンテナを起動することも可能
