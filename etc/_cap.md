# CAP定理
- 参照: [CAP定理](https://ja.wikipedia.org/wiki/CAP%E5%AE%9A%E7%90%86)
- 参照: [「メタデータ」「NoSQL」「CAP定理」を理解する](https://www.atmarkit.co.jp/ait/articles/1703/01/news204_2.html)

## TL;DR
- ネットワークでつながった共通のデータを持つ一連のノード間において、
  一貫性、可用性、ネットワーク分断耐性の3要素を同時に満たすことができない
  という定理

### 一貫性(Consistency)
- データ読み込みにおいて、必ず最新のデータが参照できる、もしくはエラーを受け取ること

### 可用性(Availability)
- クライアントは必ずデータにアクセス可能であること
  - データが壊れたり、ロック待ちにならないこと
  - 単一障害点が存在しないこと

### ネットワーク分断耐性 (Partition-tolerance)
- データを複数サーバーに分散して保管できること
  - サーバーのうちどれかに障害が発生しデータが破損した場合でも、
    別サーバーによりデータが参照可能であること

## 組みあわせ
- 一貫性＋可用性
  - 単一サーバーで動作するDB
  - トランザクション処理機能により一貫性を保つ
- 可用性＋分断耐性
  - DNS、NTP、HTTPキャッシュなど
  - 複数台で運用し、特定の一台でアクセスを受け付け、ロックはかけない
  - 更新情報がサーバ間で伝搬するまでデータの不整合が発生する
- 一貫性＋分断耐性
  - 分散データベース
  - 2相、3相コミットにより一貫性を保てる
  - サーバーが増えるとロック待ちが発生する
