# 中間者攻撃(MTIM攻撃)
- プロキシサーバーが通信を中継する際に通信内容を抜き取られることで情報が漏洩する

#### 発生箇所
- 通信経路

#### 影響範囲
- アプリケーション全体

#### 影響の種類
- 通信内容の漏洩

#### 原因
- WiFi通信を中継するAPの中が悪意を持ってパケットを覗き見る

#### 対策
- HTTPSを利用することで第三者からの通信内容の傍受・改竄・意図しないリクエストの送信を防ぐ
  - 通信経路に中継型の盗聴用機器を割り込ませると通信が暗号化されていても通信内容の傍受・改竄が可能
  - 中間者攻撃中はブラウザの証明書エラーが発生する
  - 正規のSSL証明書を購入してTLSを運用する
- Cookieに`secure`属性を付与する(HTTPS以外で通信しなくなる)

## HSTS
- HTTP Strict Transport Security
- 中間者攻撃に対抗する仕組みの一つ
1. Strict-Transport-Securityレスポンスヘッダを用いて、サーバーからクライアントへHTTPSでの接続を要請する
2. ブラウザは内部にStrict-Transport-Securityレスポンスヘッダを送信したURLのデータベースを持つ
3. 指定の有効期限までブラウザは対象のURLに対してHTTPSでのリクエストを行う
    - 初回のリクエストでHTTPでの通信となる
    - ブラウザによっては事前に対象サイトを申請することで初回からHTTPSリクエストを行うようにする

## 参照
- 安全なWebアプリケーションの作り方(脆弱性が生まれる原理と対策の実践)
- Real World HTTP 第2版
