# NAT
- 参照: Linuxで動かしながら学ぶTCP/IPネットワーク入門 7
- 参照: [「NAT」の仕組みとルーターへの設定方法 ](https://www.atmarkit.co.jp/ait/articles/1512/03/news018.html)

## TL;DR
- Network Address Translation
- 少数のグローバルIPアドレスを多数のプライベートIPアドレスで共有するための仕組み
  - LAN内の特定のノード(NATノード)のみがグローバルアドレス・プライベートアドレスを持つ
  - LAN内のNATノード以外のノードはプライベートアドレスのみを持つ
  - 外部との通信を行う際はNATノードがアドレス変換を行い通信を中継する
    - 内部アドレス       - LANにおけるアドレス
    - 外部アドレス       - インターネットにおけるアドレス
    - ローカルアドレス   - NATによって変換する前のアドレス
    - グローバルアドレス - NATによって変換した後のアドレス

## 種類
### スタティックNAT
- 変換前アドレスと変換後アドレスが1対1で対応する
- 主にLAN側に設置している特定のWebサーバーをインターネットに公開する際に使用される

### ダイナミックNAT
- 変換前アドレスと変換後アドレスが多対多で対応する
- アドレス変換の際、アドレスプールの中からその時点で使われていないアドレスが選択される
  - アドレスプール - 使用可能なアドレスの範囲

### PAT(Port Address Translation / IPマスカレード / NAPT)
- 変換前アドレスと変換後アドレスが多対1で対応する
- アドレス変換の際、アドレスとポート番号を組み合わせて使用する
  - 同一のグローバルアドレスでもポート番号によってLAN側のクライアントPCを区別することができる

## Source NAT
- 一般的なNAT
- パケットの送信元にあたるプライベートIPアドレスをグローバルIPアドレスへ変換する
- 送信元がプライベートアドレス、送信先がグローバルアドレスであるケースにおいてルーターによって実行される
  - ルーターは送信元のプライベートアドレスとポート番号を書き換え、記録する
  - ルーターは送信先から返ってきたパケットの送信先を送信元のプライベートアドレスとポートへ書き換える
  - アドレスを書き換えるためのルールはルータープロセスにて`iptables(1)`を使用して設定する

## Destination Nat
WIP
