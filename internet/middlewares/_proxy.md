# プロキシ(Proxy / CDN)
- 参照: よくわかるHTTP/2の教科書P26-27
- 参照: サーバ・インフラエンジニアの基本がこれ一冊でしっかり身につく本 5

## TL;DR
- HTTP通信を中継するサーバー
- パフォーマンス向上とセキュリティ向上のために利用される
- フォワードプロキシ - システムから外部へアクセスする際に経由する
- リバースプロキシ - 外部からシステムへアクセスする際に経由する

## フォワードプロキシ

```
サーバー -> フォワードプロキシ -> インターネット -> 外部システム
```

### 用途
- 内部ネットワークから外部ネットワークにアクセスする際、
  接続元にとって好ましくない接続先への接続を制限する
- Webシステムが外部システムにアクセスする際、
  外部システムからのレスポンスを一定期間キャッシュし、
  同じAPIを何度も叩かずに済むようにする

## リバースプロキシ

```
利用者 -> インターネット -> リバースプロキシ -> サーバー
```

### 用途
- 参照: [リバースプロキシ（Reverse Proxy）](https://www.atmarkit.co.jp/ait/articles/1608/25/news034.html)

- DoS / DDoSをサーバーに代わって被弾する
- サーバーに対するアクセスの流量制限やリクエストの検査を行う
- 負荷分散によるスループット向上
- キャッシュや圧縮による高速化・スループット向上
- TLSの終端(アプリケーションデータを復号化)
- SSLの集中管理

## CDN
- リバースプロキシを世界中に展開しマネージドサービスにしたもの

## コンテンツキャッシュ
- `コンテンツを特定するキー:コンテンツ自身`の組みを有効期限つきで管理する仕組み

### キャッシュ制御に影響するレスポンスヘッダ
- `Cache-Control` - クライアントやプロキシにキャッシュ可否・条件・有効期限を伝える
- `Last-Modified` - コンテンツの最終更新日時
- `Etag` - コンテンツの同一性
- `Expires` - コンテンツの有効期限
- `Vary` - キャッシュ共有可能範囲を識別する値をプロキシに指示する
- `Cookie` - Cookieが設定されているレスポンスはキャッシュしないプロキシが多い
