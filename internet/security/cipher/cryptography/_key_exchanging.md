# 鍵交換アルゴリズム
## Diffie Hellman 鍵交換アルゴリズム
- インターネットなどの通信路で、暗号鍵(共通鍵暗号化方式の暗号鍵)を交換するための技術
- SSL/TLSやIPSecで利用される

### 動作フロー
1. 鍵を交換する主体A、Bはあらかじめ素数pと原始根gを交換しておく
    - 素数pと原始根gはDiffie HellmanグループとしてGroup1・Group2・Group5が定義されている
2. 鍵共有時、主体Aは乱数x、主体Bは乱数yをそれぞれ生成し、秘密に管理する
3. 主体Aは`n = (g ** x) mod p`を計算する
4. 主体Bは`m = (g ** y) mod p`を計算する
5. 主体A・Bはネットワークを介してn、mを交換する
6. 主体A・Bは交換された値と自身が管理する乱数からそれぞれ同じ`K(g ** x ** y mod p)`を得る
7. 主体A・Bとで共有する暗号鍵の素材として値Kを使用する

#### MITM攻撃
- DH鍵交換アルゴリズムはMTML攻撃に対して脆弱
  - 中間者が乱数x、yを偽造して主体にB、Aに返すことができるため

## 参照
- マスタリングTCP/IP 情報セキュリティ編
