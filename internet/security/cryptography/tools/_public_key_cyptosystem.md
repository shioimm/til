# 公開鍵暗号方式
- 暗号鍵と復号鍵が異なる暗号化方式
  - Ex. RSA、ElGaml方式、Rabin方式、楕円曲線暗号
- 公開鍵によって暗号化し、秘密鍵によって復号する
- 秘密鍵から公開鍵を求めることはできるが、公開鍵から秘密鍵を求めることは困難
- 共通鍵暗号に比べて処理速度が格段に遅い
- 暗号の解析は困難である一方、中間者攻撃によるなりすましによって暗号文の改竄は可能

## 動作フロー
1. 送信者-受信者間で暗号化アルゴリズムを取り決める
    - 受信者は暗号化する鍵(公開鍵)を公開している
    - 受信者は復号化する鍵(秘密鍵)を公開していない
2. 送信者は受信者の公開鍵を使用してデータを暗号化し、送信する
3. 受信者は暗号化されたデータを受信し、秘密鍵で復号化する
- 鍵の管理と配布が簡単
- 暗号化と復号化の処理に時間がかかる

## RSA
- 素因数分解問題(桁数が大きい素数2つをかけ合わせた数から各素数の値を求めるのは困難)を利用した方式
- 鍵長512、1024、2048、4096ビットのいずれか
- 公開鍵暗号とデジタル署名に使用できるアルゴリズム

```
暗号文 = 平文 ** E mod N

平文 = 暗号文 ** D mod N

公開鍵: (E, N)
秘密鍵: (D, N)
```

1. 擬似乱数生成器を使って大きな素数pとqを選ぶ
    - p、qは1024ビット以上
2. `N = p * q`を求める
    - Nは2048ビット以上
3. `L = lcm(p - 1, q - 1)`を求める(lcm: 最小公倍数)
4. 擬似乱数生成器を使って`gcd(E, L) = 1`になるときのEを求める(gcd: 最大公約数)
5. `E * D mod L = 1`になるときのDを求める
6. EとNのペアを公開鍵として公開する
7. DとNのペアを秘密鍵として安全に管理する(p、q、Lは破棄する)

### RSA-OAEP
- RSAを改良し認証機能を追加したアルゴリズム
1. 平文のハッシュ値と決まった個数の0などから作った認証の情報を平文の前に追加し、その後にRSAで暗号化する
2. 復号時、RSAで復号した後で先頭に正しい認証の情報が現れなければ認証エラーを返す

## 参照
- 食べる！SSL！　―HTTPS環境構築から始めるSSL入門
- プロフェッショナルSSL/TLS
- マスタリングTCP/IP 入門編
- 暗号技術入門 第3版
