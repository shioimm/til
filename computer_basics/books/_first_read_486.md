# 32ビットコンピュータをやさしく語る はじめて読む486 まとめ
## レジスタセット
### 一般レジスタ
#### 汎用レジスタ
- EAX
- EBX
- ECX
- EDX
- ESI
- EDI

#### ベースポインタ
- EBP

#### スタックポインタ
- ESP

#### インストラクションポインタ
- EIP

#### フラグレジスタ
- EFLAGS

#### セグメントレジスタ
- CS - マシン語命令を格納するセグメントを指定
- DS - マシン語命令の実行時にアクセスするメモリのセグメントを指定
- ES - DSレジスタの予備
- SS - マシン語命令の実行時にアクセスするスタック領域のセグメントを指定
- FS - ESレジスタの予備
- GS - ESレジスタの予備

#### システムアドレスレジスタ
- GDTR - GDTの先頭メモリアドレス・リミット値を格納
- IDTR - IDTの先頭メモリアドレス・リミット値を格納
- LDTR - 現在のタスクのLDTのセレクタ値を格納
- TR - 現在のTSSのセレクタ値を格納

#### コントロールレジスタ
- CR0
- CR1
- CR2
- CR3

#### その他
- デバッグレジスタ群
- 浮動小数点レジスタ群

## GDT(グローバルディスクリプタテーブル)
- セグメントディスクリプタを格納
- ゲートディスクリプタを格納
- TSSディスクリプタを格納

### セグメントディスクリプタ / TSSディスクリプタ
#### 構造
- セグメントベース
- リミット値
- 属性(TYPE / S / DPL / P / A)

### コールゲートディスクリプタ
#### 構造
- セレクタ値
- オフセットアドレス
- スタックコピーカウント
- 種類

## IDT(割り込みディスクリプタテーブル)
- トラップゲートディスクリプタを格納
- 割り込みゲートディスクリプタを格納
- タスクゲートディスクリプタを格納

### トラップゲートディスクリプタ / 割り込みゲートディスクリプタ
#### 構造
- セレクタ値
- オフセットアドレス
- スタックコピーカウント
- 種類

### タスクゲートディスクリプタ
#### 構造
- セレクタ値
- 属性

## LDT(ローカルディスクリプタテーブル)
- タスクごとに独立したディスクリプタテーブル(一タスクにつき一LDT)
- GDT内にLDTを指すディスクリプタを作成し、そのセレクタ値をLDTRに設定する

### LDTディスクリプタ
#### 構造
- セグメントベース
- リミット値

## RPL(Requester's Privilege Level / 要求者特権レベル)
- セグメントのアクセスにおいて、本来そのセグメントをアクセスしようとしたプログラムの特権レベル

## タスク切り替え
- CPUの状態をTSSに保存
- スタックの切り替えとパラメータのコピー
- LDTRの切り替え
- IO許可マップの切り替え(アクセスできるIOポートの制限)

### TSS(Task State Segment)
- タスク状態の保存・復元を行うレコード(一タスクにつき一TSS)
- スタック領域のアドレスを特権レベルごとに格納するフィールドを持つ
  - スタック領域はOSによって用意され、その末尾アドレスがTSSに登録される

#### 構造
- レジスタ保存部
- OS用タスク管理情報部
- IO許可マップ

## ページング
- ページディレクトリテーブル
- ページテーブル

### PTE(ページテーブルエントリ)
#### 構造
- ページ番号
- OS用ビット
- 予約ビット
- D / A / PCD / PWT / U/S / R/W / P
