# キャッシュ
- 参照: [試して理解]Linuxのしくみ 第6章 記憶階層

## プログラムの実行順序
```
1. 命令をもとに、メモリからレジスタにデータを読み出す
2. レジスタ上のデータをもとに計算する
3. 計算結果をメモリに書き戻す
```
## キャシュメモリ
- CPUに内蔵されているキャッシュ
- プログラムの実行順序1-2、プログラムの実行順序2-3の操作を行う際に、
  直接メモリとレジスタ間にデータをやりとりするのではなく、
  キャッシュメモリを介在させることによって処理を高速化する
- 読み出すデータのサイズ(キャッシュラインサイズ)はCPUごとに定められている
- メモリ読み出し後、レジスタで値が書き換えられたデータは
  キャッシュライン上でダーティな状態になる
  ダーティなデータは所定のタイミングでバックグラウンド処理としてメモリに書き戻され
  キャッシュライン上ではダーティな状態でなくなる
- キャッシュメモリがいっぱいになった時、
  キャッシュ内に存在しないデータを読み書きしようとすると、
  既存のキャッシュラインのうち一つを廃棄し、新しいデータをキャッシュに読み出す

## ページキャッシュ
- カーネルのメモリ上に存在するキャッシュ
- レジスタ - メモリ間のキャッシュであるキャッシュメモリに対して、
  メモリ - ストレージ間のキャッシュ
- キャッシュライン単位でデータを扱うキャッシュメモリに対して、
  ページキャッシュはページ単位でデータを扱う
- データは一旦カーネルのメモリ上にページキャッシュとしてコピーされ、
  プロセスのメモリにコピーされる
- データ更新の仕組み・容量枯渇時の仕組みはキャッシュメモリと同じ
