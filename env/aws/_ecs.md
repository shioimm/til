# Amazon ECS
- Amazon Elastic Container Service
- AWS独自のコンテナオーケストレーションサービス
- コンテナの管理・運用を自動化できる
- マシンやOSなどの基盤をAWSが管理・運用する
- コンテナイメージの登録・配布のためにはAmazon ECRが必要(レジストリ)
- プラットフォームとしてKubernetesを使用する場合はEKSを利用する

## 起動タイプの選択
- Fargate
  - クラスタ管理(プロビジョニング・スケーリング)が不要
  - コンテナイメージを指定するだけで簡単にコンテナを起動できる
  - コンテナを起動していなければ料金は発生しない
- EC2
  - クラスタ管理が必要
  - ノードのネットワーク構成などを細かく設定できる
  - コンテナを起動していなくてもインスタンスを起動していれば料金が発生

## ECSの構造
- サービスが複数のタスクを含み、タスクが最大10個のコンテナを含む3層構造

#### サービス
- Kubernetesにおけるレプリカセットとデプロイメントの役割を兼ねる
- タスクのローリングアップデートや死活監視を行う
- サービスの仕様はJSON形式のテキストファイルへ宣言的に記述する(サービス定義)

#### タスク
- Kubernetesにおけるポッドの役割を担う
- タスクに含まれるコンテナは、同じタスクに含まれる他のコンテナとライフサイクルを共有する
- localhostを宛先にするとタスク内のコンテナ同士で通信が可能
- タスクごとにAWSのネットワークインターフェース(Elastic Network Interface)が割り当てられる
- タスクの仕様はJSON形式のテキストファイルへ宣言的に記述する(タスク定義)

## 利点
- インフラストラクチャの管理・運用をAWSに任せることができる
- ユーザーはアプリケーション開発など本質的な仕事に集中できる
- AWSの他のサービスと統合されており、サービス同士の連携が容易
  - Amazon EC2 - サーバー仮想化サービス
  - AWS Fargate - サーバーレスなコンテナ実行環境サービス
  - AWS IAM - アクセス管理
  - Amazon Route 53 - DNSサービス
  - Amazon CloudWatch - モニタリングサービス
  - AWS CodePipeline - 自動ビルドサービス
  - AWS CodeDeploy - 自動デプロイサービス

## 欠点
- インフラストラクチャの管理・運用の権限をAWSが持つため、
  情報セキュリティマネジメントなどの要件によってはデメリットになる
- AWSに依存することでマルチクラウドへの展開が困難化する

## 参照
- 仮想化&コンテナがこれ1冊でしっかりわかる教科書
