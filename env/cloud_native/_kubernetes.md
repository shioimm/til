# Kubernetes
- Cloud Native Computing Foundationが開発するコンテナ管理ツール
- コンテナ化されたアプリケーションのデプロイ、スケーリング、管理の自動化を行う
- Kubernetes - マルチホストでのアプリケーションコンテナオーケストレーション
- docker-compose - シングルホストでのアプリケーションコンテナオーケストレーション
- 稼働基盤となるノード(サーバー)のうち、どのノードにPod(一連のコンテナ群)をどのように配備・接続するかを設定・管理する

### Kubernetesのマネージドサービス
- Amazon EKS
- GCP GKE
- Azure AKS

## コンテナオーケストレーション
- 複数のコンテナに対する運用管理作業
- オーケストレーションツール
  - コンテナオーケストレーション作業を自動化するためのツール
  - コンテナを基盤とした分散環境を実現するOSのような位置づけ
  - 物理・仮想マシンからなるクラスタ上でコンテナをスケジューリングして実行するためのプラットフォームを提供する
  - コンテナベースのインフラストラクチャを本番環境に実装する
  - 運用タスクの自動化

## 機能
- コンテナ基盤
- マイクロサービス基盤
- ポータブルなクラウド基盤

### 機能(詳細)
- サービスディスカバリーと負荷分散
  - PodにそれぞれのIPアドレスを割り振り、Podのセットに対する単一のDNS名を提供し、
    それらのPodのセットに対する負荷分散を行う
- ストレージオーケストレーション
  - ローカルストレージ、パブリッククラウドプロバイダ(GCP、AWS)、
    ネットワークストレージシステム(NFS、iSCSI、Gluster、Ceph、Cinder、Flocker)の中から
    選択されたものを自動的にマウントする
- 自己修復
  - 失敗したコンテナを再起動する
  - ノードが死んだ場合、コンテナを交換して再スケジューリングを行う
  - ユーザーが設定したヘルスチェックに反応しないコンテナをkillする
- 自動ロールアウト/ロールバック
  - アプリケーションの健全性を監視し、同時にすべてのインスタンスを殺さないようにしながら、
    アプリケーションやその構成の変更を徐々にロールアウトする
  - 何か問題が発生した場合は変更をロールバックする
- シークレットと構成管理
  - シークレットとアプリケーション構成をデプロイして更新するための
    イメージを再構築やスタック構成のシークレットの公開が不要
- 自動binパッキング
  - リソース要件やその他の制約に基づいてコンテナを自動的に配置する
- IPv4/IPv6デュアルスタック
  - PodとサービスにIPv4とIPv6のアドレスを割り当てる
- バッチ/CI実行
  - バッチやCIのワークロードを管理し、必要に応じて失敗したコンテナを置き換える
- 水平スケーリングの実行
  - コマンドでアプリケーションを上下にスケールアップしたり
    CPUの使用量に応じて自動的にスケールアップする

## オーケストレーションされたサービスを使用するために必要な要素
- レジストリ
  - Atomic Registry、Dockerレジストリなどのプロジェクト
- ネットワーク化
  - OpenvSwitchなどのプロジェクトやインテリジェントなエッジルーティング
- テレメトリー
  - heapster、kibana、hawkular、およびelasticなどのプロジェクト
- セキュリティ
  - マルチテナンシーレイヤーのあるOAUTH、LDAP、SELinux、RBACなどのプロジェクト
- 自動化
  - インストールとクラスタのライフサイクル管理のためのAnsiblePlaybooks
- サービス
  - 一般的なアプリケーション・パターンのコンテンツを含むカタログ

## 用語
- マスター
  - Kubernetesノードを制御するマシンであり、すべてのタスクの割り当て元
- ノード
  - リクエストされ、割り当てられたタスクを実行するマシン群であり、Kubernetesマスターによって制御される
- Pod
  - 一つのノードにデプロイされた、一つ以上のコンテナからなるグループ
  - Podに入っているすべてのコンテナは同じIPアドレス、IPC、ホスト名、その他のリソースを共有する
  - Podはネットワークとストレージを基盤となるコンテナから抽象化する
    - コンテナより簡単にクラスタ内で移動できる
- レプリケーション・コントローラー
  - クラスタ上で同一のPodコピーをいくつ実行するかを制御する
- サービス
  - Podから作業の定義を分離する
  - Kubernetes サービスプロキシは適切なPodに自動的にサービスリクエストを提供する
- Kubelet
  - ノード上で実行されるサービス
  - コンテナマニフェストを読み取り、定義されたコンテナが確実に開始し実行されるようにする
- kubectl
  - Kubernetesのコマンドライン設定ツール

## 引用・参照
- [Kubernetes](https://kubernetes.io/)
- [Kubernetesとは](https://www.redhat.com/ja/topics/containers/what-is-kubernetes)
- [コンテナオーケストレーションツールの“事実上の標準”という座をつかんだ「Kubernetes」。その重要性とは？](https://cn.teldevice.co.jp/column/10519/)
