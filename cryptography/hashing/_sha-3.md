# SHA-3 (KECCAK)
- SHA-1に代わって新しい標準となる一方向ハッシュ関数アルゴリズム
- 任意長のビット列を生成できる
  - 実際はSHA-2に合わせてSHA3-224、SHA3-256、SHA3-384、SHA3-512がSHA-3として規定される

#### 特性
- SHA-2と全く異なる構造
- クリーンな構成で解析しやすい
- 多様なハードウェアデバイスで動作し、組み込み用途に向いている
- ハードウェア上の実装で高い性能を示す
- SHA-3候補だった他のアルゴリズムに比べて高いセキュリティマージンを持つ
- 入力サイズの制限がない
- スポンジ構造による仕組みを採用
  - 入力メッセージをスポンジに入れる吸収フェーズ + スポンジからメッセージを取り出す搾取フェーズ

## 動作フロー
#### 吸収フェーズ
1. ハッシュ値のサイズに関わらず1600ビットの内部状態S (初期値は全て0) を用意する
2. 内部状態Sを攪拌する置換関数fを用意する
3. ハッシュ値のサイズが256ビットのSHA-3-256の場合:
   入力データをr = 1088 (= 1600 - 256 * 2) ビットのブロックに分割する
4. あまりのブロックに1 + n個分の0 + 1から成るビットを追加してrの倍数になるようにパディング
5. 内部状態Sの先頭rビットと分割した最初のブロックB0の排他的論理和をとり、内部状態S'0にする
6. 内部状態S'0を置換関数fに入力し内部状態S1とする
7. 2つめ以降n番目のブロックは前のブロックから生成した内部状態Sn-1を使って同様の処理を繰り返す

#### 搾取フェーズ
- ハッシュ値のサイズが256ビットのSHA-3-256の場合:
  最終内部状態の先頭256ビットを取り出してハッシュ値hとする

## 参照
- プロフェッショナルSSL/TLS
- マスタリングTCP/IP 情報セキュリティ編
- 暗号技術入門 第3版
- 図解即戦力　暗号と認証のしくみと理論がこれ1冊でしっかりわかる教科書
