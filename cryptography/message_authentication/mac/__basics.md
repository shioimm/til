# メッセージ認証コード (MAC: Message Authentication Code、鍵付きハッシュ)
- メッセージ認証のための手段
- ハッシュ関数を拡張することにより認証を可能にした暗号学的な関数
- 署名者と検証者は共通の秘密鍵を用いてそれぞれ署名 (MACの作成) ・検証 MACの検証) を行う
  - MACを確認することでメッセージの改竄の検出を行う
  - MACだけでは本人確認はできない (否認防止はできない)
  - 機械的な通信 (クライアント - サーバーモデル) 時に用いられる
- 任意長のメッセージと送信者・受信者が共有する鍵を入力とし、
  固定長ビットの出力 (MAC値) を計算する
  - MAC値から元のメッセージを復元することはできない
  - 鍵に依存する一方向ハッシュ関数に等しい
  - 秘匿性が必要な場合はメッセージを別途暗号化する必要がある

#### デジタル署名との違い
| -    | 署名・検証方法 | 改竄防止 | 本人確認 |
| -    | -              | -        | -        |
| 署名 | 公開鍵暗号方式 | 可能     | 不可能   |
| MAC  | 共通鍵暗号方式 | 可能     | 不可能   |

## 動作フロー
1. Alice、Bobはあらかじめ秘密鍵sとMAC生成関数を決めて共有する
2. AliceはMAC生成関数を使ってメッセージmと秘密鍵sからMAC値 (認証子、タグ) tを作成
3. AliceはメッセージmとMAC値tをBobへ送信
4. Bobは共有しておいた秘密鍵sと受信したメッセージmからMAC生成関数を使ってMAC値t'を計算
5. Bobは`t = t'`の場合受理、そうでない場合は拒否する

## MAC値の構成方法
- 一方向ハッシュ関数を用いて構成する (HMAC)
- ブロック暗号を用いて構成する (CMAC)
- その他ストリーム暗号、公開鍵暗号を用いて構成する

## 利用例
- SWIFT
  - 国際的な銀行間の送金に利用
- IPSec
  - 通信内容の認証と真正性のチェックに利用
- SSL/TLS
  - 通信内容の認証と真正性のチェックに利用

## 参照
- 暗号技術入門 第3版
- 図解即戦力　暗号と認証のしくみと理論がこれ1冊でしっかりわかる教科書
