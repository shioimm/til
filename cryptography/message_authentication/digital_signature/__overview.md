# デジタル署名
- メッセージ認証のための手段
- 署名者は自らの秘密鍵を用いて署名し、検証者は署名者の公開鍵を用いて検証を行う
  - デジタル署名を確認することでメッセージの改竄の検出及び本人確認 (否認防止) を行う
    - 署名 - メッセージに対するハッシュ値を秘密鍵で暗号化したものを生成すること
    - 検証 - 署名の有効性を確認すること
- 署名されたメッセージと署名の間に紐づけがある
- 任意長のメッセージと送信者の署名鍵を入力とし、固定長ビットの出力 (署名) を計算する
  - MAC値から元のメッセージを復元することはできない
- メッセージ全体に署名する方法(あまり使われない)とメッセージのハッシュ値に署名する方法がある
- TSAを利用して署名をタイムスタンプと組み合わせることにより署名時刻を保証することができる

#### デジタル署名に求められる安全性
- 存在的偽造困難性 (EUF: Existentially UnForgeable)
  - 署名済みメッセージと署名の組みから偽の署名が作成できないこと

#### MACとの違い
| -    | 署名・検証方法 | 改竄防止 | 本人確認 |
| -    | -              | -        | -        |
| 署名 | 公開鍵暗号方式 | 可能     | 不可能   |
| MAC  | 共通鍵暗号方式 | 可能     | 不可能   |

#### 利用例
- セキュリティ情報のアナウンス
- ソフトウェアのダウンロード
- 公開鍵の証明書
- SSL/TLS

## 動作フロー
#### 鍵生成
1. Aliceは署名鍵sと検証鍵Sのペアを作成する
2. Aliceは署名鍵sを保管し、検証鍵SをBobに安全に渡す

#### 署名
1. Aliceは署名鍵sを用いて署名したいメッセージmから署名oを生成する
2. Aliceはメッセージmと署名oの組みをBobに渡す

#### 検証
1. Bobは検証鍵Sを用いてメッセージmと署名oの組みを検証する
2. Bobは検証結果が正しい場合受理、そうでない場合は拒否する

## TSA (Time Stamping Authority：時刻認証局/タイムスタンプ局)
- メッセージのハッシュ値を受け取り、タイムスタンプと合わせてTSA自身の秘密鍵での暗号化を行う事業者
- 所有者が申請した日時にメッセージが存在すること、
  またその内容がそれ以降変更されていないことを証明する時刻認証のために利用される

## デジタル署名に利用されるアルゴリズム
- RSA
- ElGamal方式
- DSA
- ECDSA
- Rabin方式

## 参照
- マスタリングTCP/IP 情報セキュリティ編
- 暗号技術入門 第3版
- 図解即戦力　暗号と認証のしくみと理論がこれ1冊でしっかりわかる教科書
