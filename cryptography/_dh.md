# Diffie-Hellman鍵交換 (DH鍵交換)
- インターネットなどの通信路で暗号鍵 (共通鍵暗号化方式の暗号鍵) を交換するための技術
- ハイブリッド暗号化方式は事前に復号側の公開鍵が必要だが (共通鍵を暗号化するため)、
  DH法では事前に復号側の公開鍵は不要
- SSL/TLSやIPSecで利用される
- DH鍵交換アルゴリズムはMTML攻撃に対して脆弱
  - 中間者が乱数x、yを偽造して主体にB、Aに返すことができるため

#### 動作フロー
1. Alice、Bobはあらかじめgとnを決めて固定する
    - 素数gと原始根nはDiffie HellmanグループとしてGroup1・Group2・Group5が定義されている
2. 鍵共有時、主体Aは乱数a、主体Bは乱数bをそれぞれ生成し、秘密に管理する
3. Aliceは`A = (g ** a) mod n`を計算する
4. Bobは`B = (g ** b) mod n`を計算する
5. Alice・Bobはネットワークを介してA、Bを交換する
6. Aliceは`s = (B ** a) mod n`を求める
7. Bobは`s' = (A ** b) mod n`を求める
8. 冪乗の性質から`s ≡ s' ≡ (g ** (a * b) mod n)`となる
9. `(g ** (a * b) mod n)`が二者で共有される秘密の値となり、暗号鍵の素材として使用される

## 参照
- マスタリングTCP/IP 情報セキュリティ編
- 暗号技術入門 第3版
- 図解即戦力　暗号と認証のしくみと理論がこれ1冊でしっかりわかる教科書
