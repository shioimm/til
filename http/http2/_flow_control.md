# フロー制御
- ストリームはトランスポート層のようなフロー制御機能を内包する
- 通信先のウィンドウサイズ(空きバッファサイズ)の管理を行うことにより、
  通信されるデータがオーバーフローしないようにする
  - デフォルトのウィンドウサイズは64KB

## 仕組み
1. 送信側は受信側のバッファサイズの限界量のデータを送信する
2. 受信側は送信されてきたデータを順に処理する
3. 受信側はバッファに余裕が出てきたら`WINDOW_UPDATE`を使い余裕ができたサイズを送信側に返信する
4. 送信側は`WINDOW_UPDATE`を受け取り、送信できるサイズの続きのデータを送信する

## フロー制御ウィンドウ
- 受信側が受信できるデータ量を表す数値
- 送信側が`DATA`フレームを送信するたび、送信した分だけ数値が減っていく
- フロー制御ウィンドウが0になると、それ以上`DATA`フレームを送信することができなくなる
  - ウィンドウ数0時にデータが送信された場合、エラーになりコネクションが切断される
- 受信側から`WINDOW_UPDATE`フレームが送信されることによってウィンドウ数が増加する
- ウィンドウ数の初期値は`SETTINGS`フレームの`SETTINGS_WINDOW_INITIAL_SIZE`で設定される
  - デフォルト値は65535

### コネクションレベルフロー制御ウィンドウ
- 全てのストリームでの`DATA`フレーム送信によって減算される

### ストリームレベルフロー制御ウィンドウ
- ストリームごとに独立したフロー制御ウィンドウを持ち、
  該当するストリームの`DATA`フレーム送信によってのみ減算される

## `WINDOW_UODATE`フレーム
- Window Size Incrementという値を持つフレーム
  - ウィンドウ数を増加させる量を指定する
- Window Size Incrementと対象のストリームIDを指定する
  - ストリーム0を指定するとコネクションレベルフロー制御ウィンドウを増加させる

## 参照
- よくわかるHTTP/2の教科書
- Real World HTTP 第2版
