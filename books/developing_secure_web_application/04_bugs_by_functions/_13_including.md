# 安全なWebアプリケーションの作り方(脆弱性が生まれる原理と対策の実践) まとめ
- 徳丸浩 著

## 13 インクルードにまつわる問題
- インクルード -> ソースの一部を別ファイルから読み込む機能
  - require, include, import etc
- インクルードする対象のファイル名を外部から指定できる場合、意図しないファイルが指定されて脆弱性になる場合がある

### ファイルインクルード脆弱性
- 発生箇所: インクルード機能によってスクリプトを読み込んでいるページ
- 影響範囲: 全てのページ
- 影響の種類: 情報漏洩、サイト改ざん、不正な機能実行、他サイトへの攻撃(踏み台)
- 影響度合い: 大
- 利用者関与の範囲: 不要
- 対策:
  - インクルードするパス名に外部からのパラメータを含めない
  - インクルードするパス名に外部からのパラメータを含める場合は英数字に限定する

#### 事例
- URLからクエリ文字列でインクルードするファイルを指定するようなサイトにおいて、
  任意のパス名を渡されることにより意図しないファイルが開かれ、情報漏洩する / スクリプトが実行される
- ファイルのアップロードが可能なサイト、セッション変数の保存先としてファイルを使用しているサイトにおいて、
  ファイルインクルード脆弱性によって任意のファイルが開かれることによって意図しないスクリプトが実行される

#### 原因
- インクルードファイル名を外部から指定することができる
- インクルードファイル名かどうかの妥当性をチェックしていない

#### 対策
- ディレクトリトラバーサル脆弱性に対する対策と同じ
  - 外部からファイル名を指定する仕様を避ける
  - 外部からファイル名を指定する場合、ファイル名を英数字に限定する
