# Real World HTTP 歴史とコードに学ぶインターネットとウェブ技術 まとめ
- 渋川よしき 著

## TLS
- サーバーを認証し、鍵を交換して通信経路を暗号化し、通信を行う仕組み
- HTTPと共同利用されることを想定してSSL3.0を元に実装された
- 既存のプロトコルに、通信経路の安全性を追加した新たなプロトコルを作り出すことができる
  - HTTP -> HTTPS、SMTP -> SMTPS
- 暗号化されており、通信の内容を覗いたり変更することができない安定した双方向通信

### TLSを理解するために必要な技術要素
- ハッシュ関数
- 共通鍵暗号(AES)
  - RSAよりもパフォーマンスに優れる
- 公開鍵暗号(RSA)
  - 公開鍵 -> 暗号化する鍵
  - 秘密鍵 -> 複合化する鍵
  - デジタル署名
    - RSAの応用
    - 秘密鍵を公開し、公開鍵を秘密にする
    - 公開鍵によって暗号化したデータと、本文を送信する
    - 秘密鍵によってデータを復号化した際、本文との差分がないことによって、本文が改竄されていないことを保証する
- 鍵交換
  - クライアントとサーバー間で鍵の材料を作ってお互いに交換し、それぞれ計算して同じ鍵を得るアルゴリズム
- 暗号強度
  - アルゴリズムの数学的特性によって暗号強度が異なる
- 暗号スイート
  - それぞれの場面で使うアルゴリズムの組み合わせをリスト化して管理し、
サーバー/クライアント間で共通に使えるものを選択する仕組み
  - その暗号がサポートされたプロトコルバージョン、鍵交換アルゴリズム名、認証アルゴリズム、レコード暗号アルゴリズムetc
  - RFC7540では使うべきではない暗号スイートのブラックリストが定義された
- プロトコルの選択
  - アプリケーション層のプロトコルを選択する拡張機能

### TLSの通信手順
```
1. ブラウザがサーバーの信頼性を確認
  - サーバーから発行者のデジタル署名付きのSSL証明書を取得する
2. 鍵交換
  - 公開鍵暗号もしくは鍵交換専用アルゴリズムによって鍵交換を行う
3. 通信
  - 通信の暗号化を行う
  - TLS1.2以前は通信内容のハッシュ値を計算し、共通鍵暗号で暗号化していた
  - TLS1.3以降は認証付き暗号に限定される
```
- Keep-Alive、セッション再開機能(TLS1.2)、事前共有鍵(TLS1.3)などによってRTTの削減を図っている
- TLS1.3以降は鍵交換と秘密鍵暗号が分離されたため、クライアント側から鍵の交換が行えるようになった
- TCPに代わるQUIC通信方式がIFTFに提案されている
