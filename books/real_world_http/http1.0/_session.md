# Real World HTTP 歴史とコードに学ぶインターネットとウェブ技術 まとめ
- 渋川よしき 著

## 認証とセッション
- BASIC認証
- Digest認証
- クッキーによるセッション管理
```
1. クライアントがフォームからIDとPASSを送信(通信時の暗号化が必須)
2. サーバーがIDをPASSを認証し、セッショントークンを発行
3. サーバーがセッショントークンをDBに保存
4. サーバーがクライアントに送信
```

- 署名つきクッキーによるセッション管理
```
1~3までは上記と同じ
4. サーバーがクライアントに対して電子署名済みのセッショントークンを発行
5. クライアントがクッキーを再送した際、サーバーが署名を確認
# サーバー側が署名・確認を行うため、クライアントは鍵を持たない
```

### クッキー
- サーバー側のデータをクライアント側に保存させるための機構
- 名前=値の形式でヘッダーにてやり取りを行う
- 永続化されていないため、シークレットモードやブラウザ側の操作で削除される場合がある
- 容量は最大4KB
- HTTPSでは暗号化された場合にしか送信できないが、HTTPの場合は平文で送信される

#### クッキーの制約
- Expires / Max-Age属性
  - 有効期限(Max-Ageは秒単位)
- Domain属性
  - クライアントからクッキーを送信する対象のサーバー
    - デフォルトでクッキーを発行したサーバー
- Path属性
  - Domain属性のサーバーのパス
- Secure属性
  - https以外での通信を行わない
  - httpでの通信の場合に警告を発する
- HttpOnly属性
  - JavaScriptエンジンからクッキーを隠す
- SameSite属性
  - Chromeがバージョン51で導入した属性、同じオリジンのドメインに対して送信する
