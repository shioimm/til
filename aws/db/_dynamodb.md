# DynamoDB
- フルマネージドNoSQL DB (AP型)
- 項目・属性の定義がないスキーマレスなテーブル構造を持つ (一項目あたりのデータサイズ上限400KB)
- 読み書き処理に関する結果整合性をオプションで選択可能
- リージョンごとにDBが構築され、3箇所の異なるAZにデータがレプリケーションされる
- ユーザーは占有されたデータベース用仮想インスタンスを用いず、
  APIを通じてデータの書き込み・読み出し・検索などの操作を行う
- データベースへの負荷が増減したときはDynamoDB自身が自動でスケーリングを行う

#### Consistent Hunting
- DynamoDBにおいて各ノードと配置されるデータを決定するアルゴリズム
  - パーティションキー - 親キー
  - ソートキー - 子キー

#### RCUs / WCUs
- DynamoDBではテーブル単位で読み書きのパフォーマンスをスループットとして定義する
- 読み込みキャパシティユニット (RCUs) - 読み取りのスループット
  - `読み込み項目数 * 項目のサイズ` / 秒 (デフォルト)
- 書き込みキャパシティユニット (WCUs) - 書き込みのスループット
  - `書き込み項目数 * 項目のサイズ` / 秒 (デフォルト)


## AWSにおけるAP型DB
- 複数のAZにDBを配置し、各ノードにデータを分散して配置する
- RDBで可能な複雑な検索やテーブル結合はできない
- 複数のノード間で整合性が取れないケースが発生する
  - ReadRepair機能による整合 - 読み込み時に最新のデータで古いノードのデータを更新する
  - Quorumを利用する整合 - 不整合の発生時になるべく多くの一致したデータを判定する

### データ / キー
- 各ノードにデータとキーが配置される
- 親キーによって配置されるノードが決定する
- 子キーによってノード内のデータ順序を決定する (子キーは任意に設定可能)
- 子キーを作成しない場合は親キーでデータを一意に特定できるようにする
- キーにはインデックスを設定できる

## 参照
- [11. Serverless architecture](https://tomomano.github.io/learn-aws-by-coding/#sec_serverless)
- AWSの基本・仕組み・重要用語が全部わかる教科書 06-04
