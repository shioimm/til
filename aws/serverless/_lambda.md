# AWS Lambda
- 必要時に必要なだけアプリケーションを実行できるサーバーレスの中核となるサービス
- ユーザーはEC2のように占有されたインスタンスを持たず、
  アプリケーションプログラムよりも低レイヤーをAWSに委任する
- 起動回数と実行時間によって課金される

#### Lambda関数
- Lambdaで実行するアプリケーションコード + アプリケーションコードのランタイム

#### 実行環境
- Lambdaにデプロイされたアプリケーションを実行するためのDockerコンテナ (Amazon Linux / Amazon Linux 2)
- リクエストとコンテナの数は1:1で対応する

#### デプロイパッケージ
- Lambda関数をビルドして作成したパッケージ (zip / Dockerコンテナイメージ)

#### トリガー
- Lambda関数を呼び出すリソースまたは設定
- 同期呼び出し - Lambda関数からのレスポンスの返却を待つ
  - API Gateway
  - DynamoDB
  - SQS ...
- 非同期呼び出し - Lambda関数からのレスポンスの返却を待たず、リクエストの受付結果のみを受領する
  - S3
  - SNS
  - CloudWatch Events ...

#### イベント
- Lambda関数の呼び出し元から連携されるJSON形式のドキュメント

#### 同時実行数
- ある時点における実行中のLambda関数の数 (上限値あり)

#### バージョン
- Lambda関数のバージョニング機能
  - 関数コード・依存関係
  - ランタイム
  - 環境変数を含む全ての関数設定
- エイリアス - 特定のバージョンのLambda関数を指すエイリアス

#### Lambda Layers
- 複数のLambda関数が共通で利用するライブラリ、カスタムランタイム、依存関係を
  Zipファイルで切り出して共有する機能

#### Extensions
- Layersを利用したLambdaの拡張機能

## Lambda関数のライフサイクル
1. 準備処理
    - コンテナの作成
    - デプロイパッケージのロード
    - デプロイパッケージの展開
    - ランタイム起動・初期化
2. 関数の実行
3. コンテナの破棄

## 動作フロー
1. ユーザーが実行したいプログラムのコードを事前にLambdaに登録しておく
2. ユーザーがプログラムを実行したいとき、そのプログラムを実行 (invoke) するコマンドをLambda に送信する
3. Lambdaがinvokeリクエストを受け取り、プログラムの実行を開始する
4. Lambdaが実行結果をクライアントやその他の計算機に返す

## 参照
- サーバ・インフラエンジニアの基本がこれ一冊でしっかり身につく本 9.3
- [11. Serverless architecture](https://tomomano.github.io/learn-aws-by-coding/#sec_serverless)
- [AWS Lambda](https://aws.amazon.com/jp/lambda/)
- AWSの基本・仕組み・重要用語が全部わかる教科書 13-02
