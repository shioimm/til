# VPC
- Amazon Virtual Private Cloud
- AWS上にプライベートな仮想ネットワーク環境を構築するツール
  - ソフトウェア定義によってクラウドサービス上にプライベートなネットワークを作り出す
- VPC内部にはサーバーインスタンスを配置し、サブネットを切ることもできる
  - EC2インスタンスは必ずVPCの中に配置する必要がある
- 作成するリージョンと利用するCIDRブロックを指定し、一つのVPCはリージョン内でAZをまたいで作成される

## サブネット
- アベイラビリティゾーンごとにサブネットを作成し、CIDRブロックを細かく切ってサブネットに割り当てる
- サブネットごとの接続制御はネットワークACLの設定によって行う
- ノードごとの接続制御はセキュリティグループ(ファイアウォール)の設定によって行う

### サブネットの特徴
- ルーティングの制御をルートテーブルで行う
  - サブネット内の各ノードからネットワークに発信された時点でルーティングを行う
- VPC内のノード同士は直接通信できるが、VPC内ではブロードキャストパケットは利用できない
- パケットをVPCから外に出すためにはゲートウェイが必要
  - インターネットゲートウェイ
  - NATゲートウェイ
  - NATインスタンス

### サブネットの種類
#### パブリックサブネット
- デフォルトルートがインターネットゲートウェイ
- インターネットと接続されたサブネット環境
- SSHで外部からログイン可能

#### プライベートサブネット
- デフォルトルートがインターネットゲートウェイ以外
- インターネットとは遮断されたサブネット環境
- VPC内のサーバーとのみ通信を行うEC2インスタンスを配置するためのもの

## 外部との接続
- インターネットゲートウェイ - 外部との接続
- ピアリング - VPC同士の接続
- ダイレクトコネクト - オンプレミスネットワークとVPCの接続

### VPCの使用によって展開できるサービス例
- DBやファイルストレージは外部インターネットへ公開せず、
  クラウド上のWebサーバーからのみ接続を許可する
- 管理用Webサーバーは外部インターネットへ公開せず、
  オンプレミスネットワークからのみ接続を許可する
- バッチ処理などのサーバーを外部インターネットへ公開しない

## 参照
- サーバ・インフラエンジニアの基本がこれ一冊でしっかり身につく本 9.3
- Real World HTTP 第2版
- [4. Hands-on #1: 初めてのEC2インスタンスを起動する](https://tomomano.github.io/learn-aws-by-coding/#sec_first_ec2)
