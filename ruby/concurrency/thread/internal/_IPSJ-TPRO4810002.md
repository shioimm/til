# Ruby用仮想マシンYARVにおける並列実行スレッドの実装
- Rubyスレッドとネイティブスレッドを1:1のマッピングにする
- ネイティブスレッドを並行並列に実行するための排他制御のためにGLを導入する

### Rubyスレッドへの割り込み
- Rubyスレッドへの割り込みはVM内にポーリングポイントを設け、
  割り込みを行う際に対象のスレッドに対して割り込み要因を記述してから割り込みフラグをセットする
- 対象のスレッドはポーリングポイントで割り込みに気づいて割り込まれる

#### 割り込み対象のスレッドが一定時間以上ブロックしている場合は?
- 各スレッドが持つスレッド管理データに、ブロック状態をキャンセルするブロック解除関数のポインタを設定しておく
- ブロックから無事に抜けた場合はブロック解除関数の登録を削除
- ブロックに割り込みたい場合はブロック解除関数を実行 -> ブロックを抜けたら割り込みフラグをチェック。
  - 例外発生も同様に取り扱う

## 参照
- [Ruby用仮想マシンYARVにおける並列実行スレッドの実装](https://ipsj.ixsq.nii.ac.jp/ej/index.php?action=pages_view_main&active_action=repository_action_common_download&item_id=16500&item_no=1&attribute_id=1&file_no=1&page_id=13&block_id=8)
