# BPF構文
- 式 - 一つ以上のプリミティブで構成されるフィルタ
- プリミティブ - 一つ以上の修飾子 + ID文字列 or 数値で構成される

| 修飾子の種類  | 説明                     | 例                             |
| -             | -                        | -                              |
| Type          | ID文字列や数値の意味     | host, net, port                |
| Dir           | ID文字列や数値の転送方向 | src, dst                       |
| Proto         | 特定のプロトコル         | ether, ip, tcp, udp, http, ftp |

```
dst host 192.168.0.10 && tcp port 80
```

- プリミティブ: `dst host 192.168.0.10`, `tcp port 80`
- 演算子: `&&`
- Type修飾子: host, port
- Dir修飾子: dst
- Proto修飾子: tcp
- ID文字列: `192.168.0.10`, `80`

### オフセット
```
icmp[0:2] == 0x0301
```
- パケットのオフセット(位置)値 (バイト): [0]
- パケットのデータ長 (バイト): [:2]

```
tcp[13] & 4 == 4
```
- パケットのオフセット(位置)値 (バイト): [13]
- パケットのオフセット内の位置 (ビット): 4 (右辺と同じ値ならフラグON)

## 参照
- 実践パケット解析 第3版
