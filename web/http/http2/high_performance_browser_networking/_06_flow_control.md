# HTTP/2 (High Performance Browser Networking | O'Reilly)まとめ
- 引用: [HTTP/2](https://hpbn.co/http2/)

## Flow Control
- 引用：[Flow Control](https://hpbn.co/http2/#flow-control)
- フロー制御 -> 受信側が処理したくない・処理できないデータを送信側から押しつけないようにするためのメカニズム
  - 受信側がビジー状態になっている場合
  - 受信側に負荷がかかっている場合
  - 受信側が特定のストリームに一定量のリソースを割り当てるだけで良い場合
- HTTP/2においてはTCPフロー制御によって個々のストリームの配信を制御することができない
  - HTTPストリームは単一のTCP接続内で多重化されるため
  - -> HTTP/2フロー制御はクライアントとサーバー間のストリームレベル、コネクションレベルの制御を実現する

### HTTP/2フロー制御の特徴
- フロー制御には指向性がある
  - 受信側は各ストリームおよびコネクション全体に対して
    必要な任意のウィンドウサイズを設定することができる
- フロー制御はcredit-basedである
  - 受信側は送信側に対して最初の接続およびストリーム・フロー制御ウィンドウ(byte単位)を知らせる
    - ストリーム・フロー制御ウィンドウは送信側がDATAフレームを送信するたびに減少する
    - ストリーム・フロー制御ウィンドウは受信側によって送信されたWINDOW_UPDATEフレームを介して増加する
- フロー制御を無効にすることはできない
  - HTTP/2接続確立時、クライアントとサーバはSETTINGSフレームを交換し、
    フロー制御ウィンドウのサイズを両方向に設定する
    - フロー制御ウィンドウのデフォルト値は65,535バイト
    - 受信側は最大ウィンドウ・サイズ(byte単位)を設定し、
      データを受信するたびにWINDOW_UPDATEフレームを送信してウィンドウ・サイズを維持することができる
- フロー制御はhop-by-hopであり、end-to-endではない
  - 仲介者はフロー制御によってリソース使用を制御し、リソース割り当てメカニズムを実装することができる  

### HTTP/2フロー制御の実装
- フロー制御を実装するための特定のアルゴリズムはない
- 実装はクライアントとサーバーに任せられる
